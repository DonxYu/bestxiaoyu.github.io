<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-high-availability-systems-dianping" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/04/high-availability-systems-dianping/" class="article-date">
  <time datetime="2016-02-03T16:40:00.000Z" itemprop="datePublished">2016-02-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/性能/">性能</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/04/high-availability-systems-dianping/">高可用性系统在大众点评的实践与经验</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>所谓高可用性指的是系统如何保证比较高的服务可用率，在出现故障时如何应对，包括及时发现、故障转移、尽快从故障中恢复等等。本文主要以点评的交易系统的演进为主来描述如何做到高可用，并结合了一些自己的经验。需要强调的是，高可用性只是一个结果，应该更多地关注迭代过程，关注业务发展。</p>
<p>可用性的理解<br>理解目标<br>业界高可用的目标是几个9，对于每一个系统，要求是不一样的。研发人员对所设计或者开发的系统，要知道用户规模及使用场景，知道可用性的目标。<br>比如，5个9的目标对应的是全年故障5分钟。</p>
<p>result</p>
<p>拆解目标<br>几个9的目标比较抽象，需要对目标进行合理的分解，可以分解成如下两个子目标。</p>
<p>频率要低：减少出故障的次数<br>不出问题，一定是高可用的，但这是不可能的。系统越大、越复杂，只能尽量避免问题，通过系统设计、流程机制来减少出问题的概率。但如果经常出问题，后面恢复再快也是没有用的。</p>
<p>时间要快：缩短故障的恢复时间<br>故障出现时，不是解决或者定位到具体问题，而是快速恢复是第一要务的，防止次生灾害，问题扩大。这里就要求要站在业务角度思考，而不仅是技术角度思考。<br>下面，我们就按这两个子目标来分别阐述。</p>
<p>频率要低：减少出故障的次数<br>设计：根据业务变化不断进行迭代<br>以点评交易系统的演进过程为例。<br>幼儿时期：2012年前<br>使命：满足业务要求，快速上线。<br>因为2011年要快速地把团购产品推向市场，临时从各个团队抽取的人才，大部分对.NET更熟悉，所以使用.NET进行了第一代的团购系统设计。毕竟满足业务要求是第一的，还没有机会遇到可用性等质量问题。考虑比较简单，即使都挂了，量也比较小，出现问题，重启、扩容、回滚就解决问题了。<br>系统架构如下图所示。</p>
<p>result</p>
<p>###少年时期：垂直拆分（2012-2013）<br>使命：研发效率&amp;故障隔离。</p>
<p>当2012年在团单量从千到万量级变化，用户每日的下单量也到了万级时候，需要考虑的是迭代速度、研发效率。垂直拆分，有助于保持小而美的团队，研发效率才能更高。另外一方面也需要将各个业务相互隔离，比如商品首页的展示、商品详情页的展示，订单、支付流程的稳定性要求不一样。前面可以缓存，可以做静态化来保证可用性，提供一些柔性体验。后面支付系统做异地容灾，比如我们除了南汇机房支付系统，在宝山机房也部署了，只是后来发现这个系统演进太快，没有工具和机制保证双机房更新，所以后来也不好使用了。<br>系统演进如下图所示。服务垂直化了，但是数据没有完整隔离开，服务之间还需要互相访问非自己的数据。</p>
<p>result</p>
<p>青年时期：服务做小，不共享数据（2014-2015）<br>使命：支撑业务快速发展，提供高效、高可用的技术能力。</p>
<p>从2013年开始，Deal－service （商品系统）偶尔会因为某一次大流量（大促或者常规活动）而挂掉，每几个月总有那么一次，基本上可用性就在3个9徘徊。这里订单和支付系统很稳定，因为流量在商品详情页到订单有一个转化率，流量大了详情页就挂了，订单也就没有流量了。后来详情页的静态化比较好了，能减少恢复的速度，能降级，但是Deal-service的各个系统依赖太深了，还是不能保证整体端到端的可用性。<br>所以2014年对Deal-service做了很大的重构，大系统做小，把商品详情系统拆成了无数小服务，比如库存服务、价格服务、基础数据服务等等。这下商品详情页的问题解决了，后面压力就来了，订单系统的压力增大。2014年10月起，订单系统、支付系统也启动了全面微服务化，经过大约1年的实践，订单系统、促销系统、支付系统这3个领域后面的服务总和都快上百个了，后面对应的数据库20多个，这样能支撑到每日订单量百万级。<br>业务的增长在应用服务层面是可以扩容的，但是最大的单点——数据库是集中式的，这个阶段我们主要是把应用的数据访问在读写上分离，数据库提供更多的从库来解决读的问题，但是写入仍然是最大的瓶颈（MySQL的读可以扩展，而写入QPS也就小2万）。<br>这时系统演变成如下图所示。这个架构大约能支撑QPS 3000左右的订单量。</p>
<p>result</p>
<p>成年时期：水平拆分（2015至今）<br>使命：系统要能支撑大规模的促销活动，订单系统能支撑每秒几万的QPS，每日上千万的订单量。</p>
<p>2015年的917吃货节，流量最高峰，如果我们仍然是前面的技术架构，必然会挂掉。所以在917这个大促的前几个月，我们就在订单系统进行了架构升级和水平拆分，核心就是解决数据单点，把订单表拆分成了1024张表，分布在32个数据库，每个库32张表。这样在可见的未来都不用太担心了。<br>虽然数据层的问题解决了，但是我们还是有些单点，比如我们用的消息队列、网络、机房等。举几个我过去曾经遇到的不容易碰到的可用性问题：<br>服务的网卡有一个坏了，没有被监测到，后来发现另一个网卡也坏了，这样服务就挂了。<br>我们使用 cache的时候发现可用性在高峰期非常低，后来发现这个cache服务器跟公司监控系统CAT服务器在一个机柜，高峰期的流量被CAT占了一大半，业务的网络流量不够了。<br>917大促的时候我们对消息队列这个依赖的通道能力评估出现了偏差，也没有备份方案，所以造成了一小部分的延迟。<br>这个时期系统演进为下图这样：</p>
<p>result</p>
<p>未来：思路仍然是大系统做小，基础通道做大，流量分块<br>大系统做小，就是把复杂系统拆成单一职责系统，并从单机、主备、集群、异地等架构方向扩展。<br>基础通道做大就是把基础通信框架、带宽等高速路做大。<br>流量分块就是把用户流量按照某种模型拆分，让他们聚合在某一个服务集群完成，闭环解决。<br>系统可能会演进为下图这样：</p>
<p>result</p>
<p>上面点评交易系统的发展几个阶段，只以业务系统的演进为例。除了这些还有CDN、DNS、网络、机房等各个时期遇到的不同的可用性问题，真实遇到过的就有：联通的网络挂了，需要切换到电信；数据库的电源被人踢掉了，等等。</p>
<p>易运营<br>高可用性的系统一定是可运营的。听到运营，大家更多想到的是产品运营，其实技术也有运营——线上的质量、流程的运营，比如，整个系统上线后，是否方便切换流量，是否方便开关，是否方便扩展。这里有几个基本要求：</p>
<p>可限流<br>线上的流量永远有想不到的情况，在这种情况下，系统的稳定吞吐能力就非常重要了，高并发的系统一般采取的策略是快速失败机制，比如系统QPS能支撑5000，但是1万的流量过来，我能保证持续的5000，其他5000我快速失败，这样很快1万的流量就被消化掉了。比如917的支付系统就是采取了流量限制，如果超过某一个流量峰值，我们就自动返回“请稍后再试”等。</p>
<p>无状态<br>应用系统要完全无状态，运维才能随便扩容、分配流量。</p>
<p>降级能力<br>降级能力是跟产品一起来看的，需要看降级后对用户体验的影响。简单的比如：提示语是什么。比如支付渠道，如果支付宝渠道挂了，我们挂了50% ，支付宝旁边会自动出现一个提示，表示这个渠道可能不稳定，但是可以点击；当支付宝渠道挂了100% ，我们的按钮变成灰色的，不能点击，但也会有提示，比如换其他支付渠道（刚刚微信支付还挂了，就又起作用了）。另一个案例，我们在917大促的时候对某些依赖方，比如诚信的校验，这种如果判断比较耗资源，又可控的情况下，可以通过开关直接关闭或者启用。</p>
<p>result</p>
<p>可测试<br>无论架构多么完美，验证这一步必不可少，系统的可测试性就非常重要。<br>测试的目的要先预估流量的大小，比如某次大促，要跟产品、运营讨论流量的来源、活动的力度，每一张页面的，每一个按钮的位置，都要进行较准确的预估。<br>此外还要测试集群的能力。有很多同学在实施的时候总喜欢测试单台，然后水平放大，给一个结论，但这不是很准确，要分析所有的流量在系统间流转时候的比例。尤其对流量模型的测试（要注意高峰流量模型跟平常流量模型可能不一致）系统架构的容量测试，比如我们某一次大促的测试方法<br>从上到下评估流量，从下至上评估能力：发现一次订单提交有20次数据库访问，读写比例高峰期是1:1，然后就跟进数据库的能力倒推系统应该放入的流量，然后做好前端的异步下单，让整个流量平缓地下放到数据库。</p>
<p>result</p>
<p>降低发布风险<br>严格的发布流程<br>目前点评的发布都是开发自己负责，通过平台自己完成的。上线的流程，发布的常规流程模板如下：</p>
<p>result</p>
<p>灰度机制<br>服务器发布是分批的，按照10%、30%、50%、100%的发布，开发人员通过观察监控系统的曲线及系统的日志，确定业务是否正常。<br>线上的流量灰度机制，重要功能上线能有按照某种流量灰度上线能力。<br>可回滚是标配，最好有最坏情况的预案。</p>
<p>时间要快：缩短故障的恢复时间<br>如果目标就要保证全年不出故障或者出了故障在5分钟之内能解决，要对5分钟进行充分的使用。5分钟应该这样拆解：1分钟发现故障，3分钟定位故障出现在哪个服务，再加上后面的恢复时间。就是整个时间的分解，目前我们系统大致能做到前面2步，离整体5个9的目标还有差距，因为恢复的速度跟架构的设计，信息在开发、运维、DBA之间的沟通速度及工具能力，及处理问题人员的本身能力有关。<br>生命值：</p>
<p>result</p>
<p>持续关注线上运行情况<br>熟悉并感知系统变化，要快就要熟，熟能生巧，所以要关注线上运营情况。<br>了解应用所在的网络、服务器性能、存储、数据库等系统指标。<br>能监控应用的执行状态，熟悉应用自己的QPS、响应时间、可用性指标，并对依赖的上下游的流量情况同样熟悉。<br>保证系统稳定吞吐<br>系统如果能做好流量控制、容错，保证稳定的吞吐，能保证大部分场景的可用，也能很快地消化高峰流量，避免出现故障，产生流量的多次高峰。<br>故障时</p>
<p>快速的发现机制<br>告警的移动化<br>系统可用性的告警应该全部用微信、短信这种能保证找到人的通信机制。</p>
<p>告警的实时化<br>目前我们只能做到1分钟左右告警。</p>
<p>监控的可视化<br>我们系统目前的要求是1分钟发现故障，3分钟定位故障。这就需要做好监控的可视化，在所有关键service里面的方法层面打点，然后做成监控曲线，不然3分钟定位到具体是哪个地方出问题，比较困难。点评的监控系统CAT能很好的提供这些指标变化，我们系统在这些基础上也做了一些更实时的能力，比如订单系统QPS就是秒级的监控曲线。</p>
<p>result</p>
<p>有效的恢复机制<br>比如运维的四板斧：回滚、重启、扩容、下服务器。在系统不是很复杂、流量不是很高的情况下，这能解决问题，但大流量的时候就很难了，所以要更多地从流量控制、降级体验方面下功夫。</p>
<p>几点经验<br>珍惜每次真实高峰流量，建立高峰期流量模型。<br>因为平常的压力测试很难覆盖到各种情况，而线上的真实流量能如实地反映出系统的瓶颈，能较真实地评估出应用、数据库等在高峰期的表现。</p>
<p>珍惜每次线上故障复盘，上一层楼看问题，下一层楼解决问题。<br>线上出问题后，要有一套方法论来分析，比如常见的“5W”，连续多问几个为什么，然后系统思考解决方案，再逐渐落地。</p>
<p>可用性不只是技术问题。<br>系统初期：以开发为主；<br>系统中期：开发＋DBA＋运维为主；<br>系统后期：技术＋产品＋运维＋DBA。<br>系统较简单、量较小时，开发同学能比较容易地定位问题并较容易解决问题。<br>当系统进入较复杂的中期时，就需要跟运维、数据库的同学一起来看系统的瓶颈。<br>当系统进入复杂的后期时，系统在任何时候都要考虑不可用的时候如何提供柔性体验，这就需要从产品角度来思考。</p>
<p>单点和发布是可用性最大的敌人。<br>可用性要解决的核心问题就是单点，比如常见的手段：垂直拆分、水平拆分、灰度发布；单机到主备、集群、异地容灾等等。<br>另外，系统发布也是引起系统故障的关键点，比如常见的系统发布、数据库维护等其他引起系统结构变化的操作。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/02/04/high-availability-systems-dianping/" data-id="cj4quikwf000fne5s0g9mlgcy" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-gee-shadowsocks" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/02/gee-shadowsocks/" class="article-date">
  <time datetime="2016-02-02T15:37:49.000Z" itemprop="datePublished">2016-02-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vps/">Vps</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/02/gee-shadowsocks/">极路由刷Shadowsocks教程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="1-安装开发者插件，获取root权限，请先登录极路由器后台。"><a href="#1-安装开发者插件，获取root权限，请先登录极路由器后台。" class="headerlink" title="1. 安装开发者插件，获取root权限，请先登录极路由器后台。"></a>1. 安装开发者插件，获取root权限，请先登录极路由器后台。</h4><p>开通开发者模式：“云插件”&gt;“路由器信息”&gt;“高级设置”&gt;“开通”</p>
<p>安装开发者插件：“云插件”&gt;“全部插件”&gt;“开发者模式”&gt;”确定”</p>
<h4 id="2-连接路由器"><a href="#2-连接路由器" class="headerlink" title="2. 连接路由器"></a>2. 连接路由器</h4><p><img src="http://cdn.bestxiaoyu.com/images/sshgee.png" alt=""></p>
<p>极路由器地址192.168.199.1 端口1022，用户名root，密码为路由器后台登陆密码。</p>
<h4 id="3-安装ss服务"><a href="#3-安装ss服务" class="headerlink" title="3. 安装ss服务"></a>3. 安装ss服务</h4><p>复制下面命令输入，按回车键</p>
<p>cd /tmp &amp;&amp; curl -k -o 01.sh <a href="http://download.wasai.org/01.sh" target="_blank" rel="external">http://download.wasai.org/01.sh</a> &amp;&amp; sh 01.sh &amp;&amp; rm 01.sh</p>
<p>界面提示安装成功后，重新登录极路由后台，点“高级设置”会出现**选项，填写你的账号即可使用。<br><img src="http://cdn.bestxiaoyu.com/images/geeadmin.png" alt=""></p>
<p>###注意</p>
<ol>
<li><p>插件在路由器系统升级后会消失，请把自动升级改为手动升级。</p>
</li>
<li><p>请不要恢复路由器出厂设置，否则插件也会消失。</p>
</li>
</ol>
<hr>
<blockquote>
<p>微信扫一扫，请博主喝杯咖啡.<br><img src="http://cdn.bestxiaoyu.com/images%2Fcoffee.png?imageView2/1/w/200/h/200/q/75" alt="微信扫一扫，请博主喝杯咖啡."></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/02/02/gee-shadowsocks/" data-id="cj4quikw00006ne5sk4cxo3gv" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Shadowsocks/">Shadowsocks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vps/">Vps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/极路由/">极路由</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-us-tv-series" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/02/us-tv-series/" class="article-date">
  <time datetime="2016-02-02T15:17:11.000Z" itemprop="datePublished">2016-02-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Movie/">Movie</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/02/us-tv-series/">推几部高分小众到基本没人追的完结剧及在播剧</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="1-大西洋帝国"><a href="#1-大西洋帝国" class="headerlink" title="1.大西洋帝国"></a>1.大西洋帝国</h4><p>第1季-第5季豆瓣评分8.9-9.4分。原著改编的噱头，看完原著其实发现和原著关系不大。神级编剧，没错，就是黑道家族的编剧特伦斯·温特。另外马丁斯科塞斯的导演和诸多戏精的演技让这部剧可以称为是完美神作，唯一缺憾是最后一季收尾太快，仓促赶工。看完就懂纸牌屋真是弱鸡，多条主线足够烧脑，围绕主角展开的的官商黑内斗让纸牌屋相形见绌，呵呵，肯定又有人骂我+反对了，麻烦您看过再说啊，真是不知比纸牌屋高到哪里去了，识得唔识得啊？</p>
<h4 id="2-黑吃黑"><a href="#2-黑吃黑" class="headerlink" title="2.黑吃黑"></a>2.黑吃黑</h4><p>第1季-第3季豆瓣评分7.5-9.1。情节用三个字完美概括，就是杀与操。极致的暴力美学，无论是打斗枪战还是性爱场景都非常有料，是纯汉子就看黑吃黑！你看不了吃亏也看不了上当！是女流氓你也一定要看！各种男神福利让你欲罢不能！应该算现代类型剧中最血腥最富张力的，而情节并非无脑，丝丝入扣。另外，每集基本都有床戏是一大看点。喜欢看脸的人们你们有福了。（其实还有几季才完结）</p>
<h4 id="3-火线"><a href="#3-火线" class="headerlink" title="3.火线"></a>3.火线</h4><p>第1季-第5季豆瓣评分9.3-9.7，号称当年的第一神剧毫不未过，尺度略大，漏点不打码真是震惊惹。有时候单集质量要超过绝大部分的电影 ，这点尤为难得。至于很多人拿这部剧和绝命毒师来做比较，本人不做评论，看看就好。</p>
<h4 id="4-六尺之下"><a href="#4-六尺之下" class="headerlink" title="4.六尺之下"></a>4.六尺之下</h4><p>第1季-第5季豆瓣评分8.8-9.6。整部剧的基调就是压抑，震撼，伤感。神结局，泪点低的容易看哭，内心不够强大的不建议观看。生生死死，情节不能说神作，但是绝对是一部让你思考人生的神作。生命的反覆无常才能让你认识到生命的珍贵。</p>
<h4 id="5-浴血黑帮（英剧）"><a href="#5-浴血黑帮（英剧）" class="headerlink" title="5.浴血黑帮（英剧）"></a>5.浴血黑帮（英剧）</h4><p>第1季-第2季豆瓣评分8.7-9.1。由我们的墨菲主演，第二季汤老湿加入（真心是看脸的剧）。整个剧基调阴郁黑暗，BBC复古剧一向堪称良心。英版的黑道家族或者是大西洋帝国。每集都有威士忌的镜头，让我一个酒鬼也是馋。不同于以往的黑帮剧仅仅有极少的火拼场面，这部剧火拼场景出现的频率和规模都上了一个台阶，同一梯队的英国复古剧唐顿庄园属于热剧不做描述。</p>
<h4 id="6-毒枭（2015超高分新剧）"><a href="#6-毒枭（2015超高分新剧）" class="headerlink" title="6.毒枭（2015超高分新剧）"></a>6.毒枭（2015超高分新剧）</h4><p>上映首季豆瓣评分就高达9.2分。已经挤入IMDbTop250 TV 前30名。是继《纸牌屋》和《超感猎杀》后最值得期待的Netflix自制剧。<br>围绕世纪大毒枭巴勃罗·埃斯科瓦克展开。究其高分原因，不得不谈到黑帮剧和罪案剧以及刑侦剧。黑帮剧，罪案剧，刑侦局一向评分不俗，而《毒枭》恰恰是他们的延伸，也因为《绝命毒师》的火爆，此剧应运而生。说到《绝命毒师》，讲述更多的是制毒过程，毒贩间的心怀鬼胎，和人与人之间的伦理关系，而《毒枭》展现的是毒贩的无比凶残，正义必将战胜邪恶的过程。并且，此剧有极多的纪实片段，高度还原世纪大毒枭巴勃罗·埃斯科瓦克的犯罪历程，以及多国多部门协同合作共同扳倒其的艰难历程。<br>(没错，我是要黑下蛇叔）</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/02/02/us-tv-series/" data-id="cj4quikxc001fne5s3s8u7nq2" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Movie/">Movie</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TV/">TV</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/美剧/">美剧</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-xiaolinyicha" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/10/xiaolinyicha/" class="article-date">
  <time datetime="2016-01-10T06:23:07.000Z" itemprop="datePublished">2016-01-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Life/">Life</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/10/xiaolinyicha/">小林一茶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>我知这世界，本如露水般短暂。</p>
<p>然而，<br>然而。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/10/xiaolinyicha/" data-id="cj4quikxi001nne5s90v3qidi" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Life/">Life</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/词/">词</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-web-download" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/09/web-download/" class="article-date">
  <time datetime="2016-01-08T16:41:55.000Z" itemprop="datePublished">2016-01-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/09/web-download/">关于网络下载的记忆碎片</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这两天快播案庭审成了网络热点。由快播这个事情，我倒是想起了关于网络下载的一些事情来，记录一些碎片。</p>
<p>现在一般把 1997 年看做中国互联网元年。我应该在 1998 年开始接触网络（也可能 97 年底就接触一点点)，开始上网，那时候穷学生一个，没钱，想法设法利用各种机会蹭网。中国的网速从一开始就是个低速网络，说是「信息高速公路」，就没快过。从 33.6K 到 56K 的拨号线路，网速慢得要死，时断时续(掉线)，下载( Download )又是个强需求，因为要找各种各样的软件工具，于是就有了一些软件来缓解这个问题。</p>
<p>最早的下载工具包括网络吸血鬼(Net Vampire)、网络蚂蚁 (NetAnts)，可能还有很多，但只记得这两个产品了。前者是一款英文软件，支持断点续传，后者则是中国程序员开发的工具。网络蚂蚁出现的稍晚一点，但技术上有更多改进，更适合中国当时的网络环境，很快就火了起来。</p>
<p>网络蚂蚁的作者是洪以容，当时还在上海交大念书。这个人应该在中国的软件史上留下一笔，开发网络蚂蚁不算，他还积极探索了共享软件的商业模式，率先启用了广告条(Adware)来获取收入。现在看起来这都是再正常不过的事情，但在当时还是引起了一番风波，有人担心广告条会窃取隐私，也有人质疑这样做的合理性，那个时候的网民说实话素质还是挺高的，能上网的都是一些教育水平蛮高的人，在网络上还能理性探讨一些事情。几年之后洪以容放弃了网络蚂蚁，据说去做金融软件工具去了，如果你好奇他赚没赚到钱，各种消息源都提到: 收入不错，肯定要比写软件要好一些。</p>
<p>洪以容写网络蚂蚁遇到好几件被误会的事，估计也让他烦心吧。网络蚂蚁刚推出的时候被很多人以为是老外写的工具，因为只有英文版，发现是国人作品之后，有人说他「假洋鬼子」，后面的广告风波，估计也挺伤人家自尊心的。</p>
<p>网络蚂蚁的界面在当时来看，很漂亮。网络上有一批人专门做软件破解，很快就有人出了补丁工具，可以去掉广告条，惭愧的是，我当时很喜欢用这些补丁工具。</p>
<p>当时下载的需求主要是下载各类软件工具，很少有人下载多媒体内容。有的时候在网吧也挂上一些链接抓多媒体，但用的不多。</p>
<p>各种下载站点也应运而生，比较有名的有华军下载站，还有高春辉做的下载站，现在这两个人也都活跃在互联网圈子，我和高春辉还成了朋友。老高最近在做 IP 库的事情，建议有需求的公司都去买一份。这就是我说的，花钱可以快速解决的事情，不用自己折腾了。</p>
<p>没过多久侯延堂开发的网际快车就出来了，刚出来的时候叫 JetCar，一年多后英文名改成了 FlashGet。因为产品改进快，吸收了前面多个工具的优点，网际快车很快就超过了网络蚂蚁，一段时间内，成为中国人开发的最流行的工具，说是全世界都在用也不夸张。</p>
<p>这个工具后来在 2006 年被一家电子杂志运营商收购了，很不靠谱，后来这个工具当然是被玩死了，通过工具来分发那么大个儿的电子杂志，不知道怎么想的，脑子进水了吧。</p>
<p>2005 年前后是中国互联网的黑暗时代，各种流氓软件横行，恶意弹窗，乌烟瘴气的。现在的一些知名互联网公司，都有原罪，包括现在的各种互联网巨头。这是他们洗不清的污点，时代的烙印。</p>
<p>FlashGet 被收购的时候其实已经走下坡路了，因为这个时候，迅雷已经在崛起。业界传说在两者竞争的时候，「侯延堂迷恋魔兽世界，停止更新软件长达一年，市场份额被迅雷迅速占领」，不知真假，从结果上看，可能是真的。话说魔兽世界真是没少祸害人啊，但也可能是子非鱼，安知鱼之乐。</p>
<p>迅雷出现之前，BitTorrent (BT) 软件已经开始流行了。BitTorrent 的作者 Bram Cohen 有自闭症，却通过这样一款工具改变了信息交换的方式。</p>
<p>应该说，BitTorrent 和 eMule 这样的 P2P 下载工具促成了一次信息分发的革命。如果没有这些软件，这个世界会无趣很多，尽管，这个过程一直伴随着各种争议。技术的进步就是这样。</p>
<p>从 2000 年到 2005 这段时间里，国内也有很多其他类似的工具，能想起来的有天网 Maze、PP 点点通等等，能搜到很多「有趣」的内容。开发天网 Maze 的陈华后来做了酷讯，现在则是创建了唱吧。</p>
<p>2001 年之后的几年我热衷于泡网络论坛，技术论坛为主，也有音乐论坛。这两个地方的用户其实也都有下载需求，前者是技术书籍和各种技术资料，后者，则主要是找一些冷门的 MP3，这时候也开始用一些特定的 P2P 工具来找音乐，比如 Shareaza ，刚搜索了一下，这个工具居然现在还活着。</p>
<p>应该说，中国网民对色情内容的渴求是一种极强的驱动力，另一种驱动力是盗版电影，这两种需求催生了中国巨大的下载市场，产生了好几家互联网公司，迅雷如是，最近被审判的快播也是。</p>
<p>曾经有人对盗版肆虐忧心忡忡，认为会扼杀各种电影公司，现在看看，反倒是电影产业迎来了空前繁荣。这是为什么呢? 我不明白。</p>
<p>作为技术人员，我清楚的记得是从 2004 年夏天才开始用 BT 下载电影，已经算很晚了，主要是开始用了几次，没体会到到底好在哪里。后来忍不住挂了一堆种子，然后去睡觉了。半夜起来，听到笔记本硬盘滋滋响，凑过去一看，下载速度达到 1Mb/s ，惊呆。要知道当时的宽带只有 512Kb，我用的是小区宽带，其实是假宽带，有的时候慢的要命，网络空闲的时候跑出这个速度倒是也可以解释。然后就不可救药的喜欢上了这个工具。</p>
<p>通过 BT ，确实一下子看了好多电影。2004 年我住在北京人大西门，人大西门对面有个小店，里面就有卖盗版电影的，有很多好片子可以挑选，经典电影，艺术片也有(没有毛片)。要不是 BT 出现了，我可能还会买很多 DVD 光盘。</p>
<p>BT 出现降低了下载毛片的门槛。以后分析中国这一代人的性认知革命，应该好好说说这一段。</p>
<p>那么，BT 出现之前都怎么找毛片的呢？我赶上了录像带时代的尾声，仅仅留下一些记忆残存，更多有记忆的，真正有震撼的还是电脑城的光盘市场。</p>
<p>当时长春的几家电脑城，卖软件光盘那一层几乎每家都卖毛片，开始的时候还遮遮掩掩，要到柜台后面去挑，神秘兮兮的。等到了我毕业后，再次故地重游，发现这些商家大胆到直接把光盘封面用胶带粘起来，方便顾客挑选。我带了一位同事去逛电脑城，那位同事大呼过瘾，现在想起来，这就是业务模式的创新啊。</p>
<p>那是在 2001 年，盗版光盘时代的最后荣光。确切的说，是在冬天。因为璩美凤的盗版光盘已经上市，如果你对这个名字有印象的话，我相信你是个老司机。</p>
<p>说起来，我并不是快播的用户，对快播没有什么情感，倒是用过很长时间的迅雷，虽然迅雷软件界面很烂，耗费系统资源，还有各种垃圾广告，但架不住下载速度快，能解决关键的需求，其他都可以忍。</p>
<p>无可奈何花落去，迅雷毕竟是一个时代的产物，过了这个时代，CDN 技术已经兴起，网络提速到可以直接观看在线视频的时代，迅雷就只能是一种补充了，到了今天，在我看来，迅雷已经不可避免的逐渐变成地下暗网的一部分。</p>
<p>迅雷没及早转身进入 CDN 业务，没蜕变成为云计算公司，都是非常可惜的，这是迅雷创始团队的失败，这家公司，本来倒是有机会成为中国的 Netflix。</p>
<p>这么多年过去，中国的网络基础设施已经没那么差了，但大环境反而变得更差，有信息洪流，也有铸就的虚拟高墙。我说的是什么，你应该明白。</p>
<p>写这些东西有什么意义呢？算是一份记录吧，以免以后都忘了一些事情。这是过去的印迹，就是那样。</p>
<p>附送一改编的小笑话：</p>
<p>昔有一僧人，与一士子同宿夜航船。士子高谈阔论，僧畏慑，拳足而寝。僧人听其语有破绽，乃曰：「请问相公，澹台灭明是一个人、两个人？」 士子曰：「是两个人。」僧曰：「川岛和津实是一个人、两个人？」士子曰：「自然也是两个人！」僧乃笑曰：「这等说起来，且待小僧伸伸脚。」</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/09/web-download/" data-id="cj4quikxg001lne5s4mhalui8" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-performance-tuning-pattern" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/10/performance-tuning-pattern/" class="article-date">
  <time datetime="2015-12-10T09:00:00.000Z" itemprop="datePublished">2015-12-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/性能优化/">性能优化</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/10/performance-tuning-pattern/">性能优化模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>摘要<br>性能优化涉及面很广。一般而言，性能优化指降低响应时间和提高系统吞吐量两个方面，但在流量高峰时候，性能问题往往会表现为服务可用性下降，所以性能优化也可以包括提高服务可用性。在某些情况下，降低响应时间、提高系统吞吐量和提高服务可用性三者相互矛盾，不可兼得。例如：增加缓存可以降低平均响应时间，但是处理线程数量会因为缓存过大而有所限制，从而降低系统吞吐量；为了提高服务可用性，对异常请求重复调用是一个常用的做法，但是这会提高响应时间并降低系统吞吐量。</p>
<p>对于很多像美团这样的公司，它们的系统会面临如下三个挑战：1. 日益增长的用户数量，2. 日渐复杂的业务，3. 急剧膨胀的数据。这些挑战对于性能优化而言表现为：在保持和降低系统TP95响应时间（指的是将一段时间内的请求响应时间从低到高排序，高于95%请求响应时间的下确界）的前提下，不断提高系统吞吐量，提升流量高峰时期的服务可用性。这种场景下，三者的目标和改进方法取得了比较好的一致。本文主要目标是为类似的场景提供优化方案，确保系统在流量高峰时期的快速响应和高可用。</p>
<p>文章第一部分是介绍，包括采用模式方式讲解的优点，文章所采用案例的说明，以及后面部分用到的一些设计原则；第二部分介绍几种典型的“性能恶化模式”，阐述导致系统性能恶化，服务可用性降低的典型场景以及形成恶化循环的过程；第三部分是文章重点，阐述典型的“性能优化模式”，这些模式或者可以使服务远离“恶化模式”，或者直接对服务性能进行优化；文章最后一部分进行总结，并对未来可能出现的新模式进行展望。</p>
<p>介绍<br>模式讲解方式<br>关于性能优化的文章和图书已有很多，但就我所知，还没有采用模式的方式去讲解的。本文借鉴《设计模式》（”Design Patterns-Elements of Reusable Object-Oriented Software”）对设计模式的阐述方式，首先为每一种性能优化模式取一个贴切的名字，便于读者快速理解和深刻记忆，接着讲解该模式的动机和原理，然后结合作者在美团的具体工作案例进行深度剖析，最后总结采用该模式的优点以及需要付出的代价。简而言之，本文采用“命名–&gt;原理和动机–&gt;具体案例–&gt;缺点和优点”的四阶段方式进行性能优化模式讲解。与其他方式相比，采用模式进行讲解有两个方面的优点：一方面，读者不仅仅能够掌握优化手段，而且能够了解采用该手段进行性能优化的场景以及所需付出的代价，这有利于读者全面理解和灵活应用；另一方面，模式解决的是特定应用场景下的一类问题，所以应用场景描述贯穿于模式讲解之中。如此，即使读者对原理不太了解，只要碰到的问题符合某个特定模式的应用场景（这往往比理解原理要简单），就可以采用对应的手段进行优化，进一步促进读者对模式的理解和掌握。</p>
<p>案例说明<br>文章的所有案例都来自于美团的真实项目。出于两方面的考虑，作者做了一定的简化和抽象：一方面，系统可以优化的问题众多，而一个特定的模式只能解决几类问题，所以在案例分析过程中会突出与模式相关的问题；另一方面，任何一类问题都需要多维度数据去描述，而应用性能优化模式的前提是多维度数据的组合值超过了某个临界点，但是精确定义每个维度数值的临界点是一件很难的事情，更别说多维度数据组合之后临界点。因此有必要对案例做一些简化，确保相关取值范围得到满足。基于以上以及其他原因，作者所给出的解决方案只是可行性方案，并不保证其是所碰到问题的最佳解决方案。</p>
<p>案例涉及的所有项目都是基于Java语言开发的，严格地讲，所有模式适用的场景是基于Java语言搭建的服务。从另外一方面讲，Java和C++的主要区别在于垃圾回收机制，所以，除去和垃圾回收机制紧密相关的模式之外，文章所描述的模式也适用于采用C++语言搭建的服务。对于基于其他语言开发的服务，读者在阅读以及实践的过程中需要考虑语言之间的差别。</p>
<p>设计原则<br>必须说明，本文中各种模式所要解决的问题之所以会出现，部分是因为工程师运用了某些深层次的设计原则。有些设计原则看上去和优秀的设计理念相悖，模式所解决的问题似乎完全可以避免，但是它们却被广泛使用。“存在即合理”，世界上没有完美的设计方案，任何方案都是一系列设计原则的妥协结果，所以本文主要关注点是解决所碰到的问题而不是如何绕过这些设计原则。下面对文中重要的设计原则进行详细阐述，在后面需要运用该原则时将不再解释。</p>
<p>最小可用原则<br>最小可用原则（快速接入原则）有两个关注点：1. 强调快速接入，快速完成；2. 实现核心功能可用。这是一个被普遍运用的原则，其目标是缩短测试周期，增加试错机会，避免过度设计。为了快速接入就必须最大限度地利用已有的解决方案或系统。从另外一个角度讲，一个解决方案或系统只要能够满足基本需求，就满足最小可用原则的应用需求。过度强调快速接入原则会导致重构风险的增加，原则上讲，基于该原则去设计系统需要为重构做好准备。</p>
<p>经济原则<br>经济原则关注的是成本问题，看起来很像最小可用原则，但是它们之间关注点不同。最小可用原则的目标是通过降低开发周期，快速接入而实现风险可控，而快速接入并不意味着成本降低，有时候为了实现快速接入可能需要付出巨大的成本。软件项目的生命周期包括：预研、设计、开发、测试、运行、维护等阶段。最小可用原则主要运用在预研阶段，而经济原则可以运用在整个软件生命周期里，也可以只关注某一个或者几个阶段。例如：运行时经济原则需要考虑的系统成本包括单次请求的CPU、内存、网络、磁盘消耗等；设计阶段的经济原则要求避免过度设计；开发阶段的经济原则可能关注代码复用，工程师资源复用等。</p>
<p>代码复用原则<br>代码复用原则分为两个层次：第一个层次使用已有的解决方案或调用已存在的共享库（Shared Library），也称为方案复用；第二个层次是直接在现有的代码库中开发，也称之为共用代码库。</p>
<p>方案复用是一个非常实用主义的原则，它的出发点就是最大限度地利用手头已有的解决方案，即使这个方案并不好。方案的形式可以是共享库，也可以是已存在的服务。方案复用的例子参见避免蚊子大炮模式的具体案例。用搜索引擎服务来解决查找附近商家的问题是一个性能很差的方案，但仍被很多工程师使用。方案复用原则的一个显著优点就是提高生产效率，例如：Java之所以能够得到如此广泛应用，原因之一就是有大量可以重复利用的开源库。实际上“Write once, run anywhere”是Java语言最核心的设计理念之一。基于Java语言开发的代码库因此得以在不同硬件平台、不同操作系统上更广泛地使用。</p>
<p>共用代码库要求在同一套代码库中完成所有功能开发。采用这个原则，代码库中的所有功能编译时可见，新功能代码可以无边界的调用老代码。另外，原代码库已存在的各种运行、编译、测试、配置环境可复用。主要有两个方面地好处：1. 充分利用代码库中已有的基础设施，快速接入新业务；2. 直接调用原代码中的基础功能或原語，避免网络或进程间调用开销，性能更佳。共用代码库的例子参见垂直分割模式的具体案例。</p>
<p>从设计的角度上讲，方案复用类似于微服务架构（Microservice Architecture，有些观点认为这是一种形式的SOA），而共用代码库和Monolithic Architecture很接近。总的来说，微服务倾向于面向接口编程，要求设计出可重用性的组件（Library或Service），通过分层组织各层组件来实现良好的架构。与之相对应，Monolith Architecture则希望尽可能在一套代码库中开发，通过直接调用代码中的基础功能或原語而实现性能的优化和快速迭代。使用Monolith Architecture有很大的争议，被认为不符合“设计模式”的理念。参考文献[4]，Monolithic Design主要的缺点包括：1. 缺乏美感；2. 很难重构；3. 过早优化（参见文献[6]Optimize judiciously）; 4. 不可重用；5. 限制眼界。微服务架构是很多互联网公司的主流架构，典型的运用公司包括Amazon、美团等。Monolithic Architecture也有其忠实的粉丝，例如：Tripadvisor的全球网站就共用一套代码库；基于性能的考虑，Linux最终选择的也是Monolithic kernel的模式。</p>
<p>奥卡姆剃刀原则<br>系统设计以及代码编写要遵循奥卡姆剃刀原则：Entities should not be multiplied unnecessarily。一般而言，一个系统的代码量会随着其功能增加而变多。系统的健壮性有时候也需要通过编写异常处理代码来实现。异常考虑越周全，异常处理代码量越大。但是随着代码量的增大，引入Bug的概率也就越大，系统也就越不健壮。从另外一个角度来讲，异常流程处理代码也要考虑健壮性问题，这就形成了无限循环。所以在系统设计和代码编写过程中，奥卡姆剃刀原则要求：一个功能模块如非必要，就不要；一段代码如非必写，就不写。</p>
<p>奥卡姆剃刀原则和最小可用原则有所区别。最小可用原则主要运用于产品MVP阶段，本文所指的奥卡姆剃刀原则主要指系统设计和代码编写两个方面，这是完全不同的两个概念。MVP包含系统设计和代码编写，但同时，系统设计和代码编写也可以发生在成熟系统的迭代阶段。</p>
<p>性能恶化模式<br>在讲解性能优化模式之前，有必要先探讨一下性能恶化模式，因为：</p>
<p>很多性能优化模式的目标之一就是避免系统进入性能恶化模式；<br>不同性能优化模式可能是避免同一种性能恶化模式；<br>同一种性能优化模式可能在不同阶段避免不同的性能恶化模式。<br>在此统一阐述性能恶化模式，避免下文重复解释。为了便于读者清晰识别恶化模式和优化模式，恶化模式采用“XXX反模式”的方式进行命名。<br>长请求拥塞反模式（High Latency Invocating AntiPattern）<br>这是一种单次请求时延变长而导致系统性能恶化甚至崩溃的恶化模式。对于多线程服务，大量请求时间变长会使线程堆积、内存使用增加，最终可能会通过如下三种方式之一恶化系统性能：</p>
<p>线程数目变多导致线程之间CPU资源使用冲突，反过来进一步延长了单次请求时间；<br>线程数量增多以及线程中缓存变大，内存消耗随之剧增，对于基于Java语言的服务而言，又会更频繁地full GC，反过来单次请求时间会变得更长；<br>内存使用增多，会使操作系统内存不足，必须使用Swap，可能导致服务彻底崩溃。<br>典型恶化流程图如下图：<br>长请求拥塞反模式<br>长请求拥塞反模式所导致的性能恶化现象非常普遍，所以识别该模式非常重要。典型的场景如下：某复杂业务系统依赖于多个服务，其中某个服务的响应时间变长，随之系统整体响应时间变长，进而出现CPU、内存、Swap报警。系统进入长请求拥塞反模式的典型标识包括：被依赖服务可用性变低、响应时间变长、服务的某段计算逻辑时间变长等。</p>
<p>多次请求杠杆反模式（Levered Multilayer Invocating AntiPattern）<br>客户端一次用户点击行为往往会触发多次服务端请求，这是一次请求杠杆；每个服务端请求进而触发多个更底层服务的请求，这是第二次请求杠杆。每一层请求可能导致一次请求杠杆，请求层级越多，杠杆效应就越大。在多次请求杠杆反模式下运行的分布式系统，处于深层次的服务需要处理大量请求，容易会成为系统瓶颈。与此同时，大量请求也会给网络带来巨大压力，特别是对于单次请求数据量很大的情况，网络可能会成为系统彻底崩溃的导火索。典型恶化流程图如下图：<br>多次请求杠杆反模式<br>多次请求杠杆所导致的性能恶化现象非常常见，例如：对于美团推荐系统，一个用户列表请求会有多个算法参与，每个算法会召回多个列表单元（商家或者团购），每个列表单元有多种属性和特征，而这些属性和特征数据服务又分布在不同服务和机器上面，所以客户端的一次用户展现可能导致了成千上万的最底层服务调用。对于存在多次请求杠杆反模式的分布式系统，性能恶化与流量之间往往遵循指数曲线关系。这意味着，在平常流量下正常运行服务系统，在流量高峰时通过线性增加机器解决不了可用性问题。所以，识别并避免系统进入多次请求杠杆反模式对于提高系统可用性而言非常关键。</p>
<p>反复缓存反模式（Recurrent Caching AntiPattern）<br>为了降低响应时间，系统往往在本地内存中缓存很多数据。缓存数据越多，命中率就越高，平均响应时间就越快。为了降低平均响应时间，有些开发者会不加限制地缓存各种数据，在正常流量情况下，系统响应时间和吞吐量都有很大改进。但是当流量高峰来临时，系统内存使用开始增多，触发了JVM进行full GC，进而导致大量缓存被释放（因为主流Java内存缓存都采用SoftReference和WeakReference所导致的），而大量请求又使得缓存被迅速填满，这就是反复缓存。反复缓存导致了频繁的full GC，而频繁full GC往往会导致系统性能急剧恶化。典型恶化流程图如下图：<br>反复缓存反模式<br>反复缓存所导致性能恶化的原因是无节制地使用缓存。缓存使用的指导原则是：工程师们在使用缓存时必须全局考虑，精细规划，确保数据完全缓存的情况下，系统仍然不会频繁full GC。为了确保这一点，对于存在多种类型缓存以及系统流量变化很大的系统，设计者必须严格控制缓存大小，甚至废除缓存（这是典型为了提高流量高峰时可用性，而降低平均响应时间的一个例子）。反复缓存反模式往往发生在流量高峰时候，通过线性增加机器和提高机器内存可以大大减少系统崩溃的概率。</p>
<p>性能优化模式<br>水平分割模式（Horizontal partitioning Pattern）<br>原理和动机<br>典型的服务端运行流程包含四个环节：接收请求、获取数据、处理数据、返回结果。在一次请求中，获取数据和处理数据往往多次发生。在完全串行运行的系统里，一次请求总响应时间满足如下公式：</p>
<p>一次请求总耗时=解析请求耗时 + ∑(获取数据耗时+处理数据耗时) + 组装返回结果耗时</p>
<p>大部分耗时长的服务主要时间都花在中间两个环节，即获取数据和处理数据环节。对于非计算密集性的系统，主要耗时都用在获取数据上面。获取数据主要有三个来源：本地缓存，远程缓存或者数据库，远程服务。三者之中，进行远程数据库访问或远程服务调用相对耗时较长，特别是对于需要进行多次远程调用的系统，串行调用所带来的累加效应会极大地延长单次请求响应时间，这就增大了系统进入长请求拥塞反模式的概率。如果能够对不同的业务请求并行处理，请求总耗时就会大大降低。例如下图中，Client需要对三个服务进行调用，如果采用顺序调用模式，系统的响应时间为18ms，而采用并行调用只需要7ms。<br>水平分割模式</p>
<p>水平分割模式首先将整个请求流程切分为必须相互依赖的多个Stage，而每个Stage包含相互独立的多种业务处理（包括计算和数据获取）。完成切分之后，水平分割模式串行处理多个Stage，但是在Stage内部并行处理。如此，一次请求总耗时等于各个Stage耗时总和，每个Stage所耗时间等于该Stage内部最长的业务处理时间。</p>
<p>水平分割模式有两个关键优化点：减少Stage数量和降低每个Stage耗时。为了减少Stage数量，需要对一个请求中不同业务之间的依赖关系进行深入分析并进行解耦，将能够并行处理的业务尽可能地放在同一个Stage中，最终将流程分解成无法独立运行的多个Stage。降低单个Stage耗时一般有两种思路：1. 在Stage内部再尝试水平分割（即递归水平分割)，2. 对于一些可以放在任意Stage中进行并行处理的流程，将其放在耗时最长的Stage内部进行并行处理，避免耗时较短的Stage被拉长。</p>
<p>水平分割模式不仅可以降低系统平均响应时间，而且可以降低TP95响应时间（这两者有时候相互矛盾，不可兼得）。通过降低平均响应时间和TP95响应时间，水平分割模式往往能够大幅度提高系统吞吐量以及高峰时期系统可用性，并大大降低系统进入长请求拥塞反模式的概率。</p>
<p>具体案例<br>我们的挑战来自为用户提供高性能的优质个性化列表服务，每一次列表服务请求会有多个算法参与，而每个算法基本上都采用“召回-&gt;特征获取-&gt;计算”的模式。 在进行性能优化之前，算法之间采用顺序执行的方式。伴随着算法工程师的持续迭代，算法数量越来越多，随之而来的结果就是客户端响应时间越来越长，系统很容易进入长请求拥塞反模式。曾经有一段时间，一旦流量高峰来临，出现整条服务链路的机器CPU、内存报警。在对系统进行分析之后，我们采取了如下三个优化措施，最终使得系统TP95时间降低了一半：</p>
<p>算法之间并行计算；<br>每个算法内部，多次特征获取进行了并行处理；<br>在调度线程对工作线程进行调度的时候，耗时最长的线程最先调度，最后处理。<br>缺点和优点<br>对成熟系统进行水平切割，意味着对原系统的重大重构，工程师必须对业务和系统非常熟悉，所以要谨慎使用。水平切割主要有两方面的难点：</p>
<p>并行计算将原本单一线程的工作分配给多线程处理，提高了系统的复杂度。而多线程所引入的安全问题让系统变得脆弱。与此同时，多线程程序测试很难，因此重构后系统很难与原系统在业务上保持一致。<br>对于一开始就基于单线程处理模式编写的系统，有些流程在逻辑上能够并行处理，但是在代码层次上由于相互引用已经难以分解。所以并行重构意味着对共用代码进行重复撰写，增大系统的整体代码量，违背奥卡姆剃刀原则。<br>对于上面提到的第二点，举例如下：A和B是逻辑可以并行处理的两个流程，基于单线程设计的代码，假定处理完A后再处理B。在编写处理B逻辑代码时候，如果B需要的资源已经在处理A的过程中产生，工程师往往会直接使用A所产生的数据，A和B之间因此出现了紧耦合。并行化需要对它们之间的公共代码进行拆解，这往往需要引入新的抽象，更改原数据结构的可见域。<br>在如下两种情况，水平切割所带来的好处不明显：</p>
<p>一个请求中每个处理流程需要获取和缓存的数据量很大，而不同流程之间存在大量共享的数据，但是请求之间数据共享却很少。在这种情况下，流程处理完之后，数据和缓存都会清空。采用顺序处理模式，数据可以被缓存在线程局部存储（ThreadLocal）中而减少重复获取数据的成本；如果采用水平切割的模式，在一次请求中，不同流程会多次获取并缓存的同一类型数据，对于内存原本就很紧张的系统，可能会导致频繁full GC，进入反复缓存反模式。<br>某一个处理流程所需时间远远大于其他所有流程所需时间的总和。这种情况下，水平切割不能实质性地降低请求响应时间。<br>采用水平切割的模式可以降低系统的平均响应时间和TP95响应时间，以及流量高峰时系统崩溃的概率。虽然进行代码重构比较复杂，但是水平切割模式非常容易理解，只要熟悉系统的业务，识别出可以并行处理的流程，就能够进行水平切割。有时候，即使少量的并行化也可以显著提高整体性能。对于新系统而言，如果存在可预见的性能问题，把水平分割模式作为一个重要的设计理念将会大大地提高系统的可用性、降低系统的重构风险。总的来说，虽然存在一些具体实施的难点，水平分割模式是一个非常有效、容易识别和理解的模式。</p>
<p>垂直分割模式（Vertical partitioning Pattern）<br>原理和动机<br>对于移动互联网节奏的公司，新需求往往是一波接一波。基于代码复用原则，工程师们往往会在一个系统实现大量相似却完全不相干的功能。伴随着功能的增强，系统实际上变得越来越脆弱。这种脆弱可能表现在系统响应时间变长、吞吐量降低或者可用性降低。导致系统脆弱原因主要来自两方面的冲突：资源使用冲突和可用性不一致冲突。</p>
<p>资源使用冲突是导致系统脆弱的一个重要原因。不同业务功能并存于同一个运行系统里面意味着资源共享，同时也意味着资源使用冲突。可能产生冲突的资源包括：CPU、内存、网络、I/O等。例如：一种业务功能，无论其调用量多么小，都有一些内存开销。对于存在大量缓存的业务功能，业务功能数量的增加会极大地提高内存消耗，从而增大系统进入反复缓存反模式的概率。对于CPU密集型业务，当产生冲突的时候，响应时间会变慢，从而增大了系统进入长请求拥塞反模式的可能性。</p>
<p>不加区别地将不同可用性要求的业务功能放入一个系统里，会导致系统整体可用性变低。当不同业务功能糅合在同一运行系统里面的时候，在运维和机器层面对不同业务的可用性、可靠性进行调配将会变得很困难。但是，在高峰流量导致系统濒临崩溃的时候，最有效的解决手段往往是运维，而最有效手段的失效也就意味着核心业务的可用性降低。</p>
<p>垂直分割思路就是将系统按照不同的业务功能进行分割，主要有两种分割模式：部署垂直分割和代码垂直分割。部署垂直分割主要是按照可用性要求将系统进行等价分类，不同可用性业务部署在不同机器上，高可用业务单独部署；代码垂直分割就是让不同业务系统不共享代码，彻底解决系统资源使用冲突问题。</p>
<p>具体案例<br>我们的挑战来自于美团推荐系统，美团客户端的多个页面都有推荐列表。虽然不同的推荐产品需求来源不同，但是为了实现快速的接入，基于共用代码库原则，所有的推荐业务共享同一套推荐代码，同一套部署。在一段时间内，我们发现push推荐和首页“猜你喜欢推荐”的资源消耗巨大。特别是在push推荐的高峰时刻，CPU和内存频繁报警，系统不停地full GC，造成美团用户进入客户端时，首页出现大片空白。</p>
<p>在对系统进行分析之后，得出两个结论：</p>
<p>首页“猜你喜欢”对用户体验影响更大，应该给予最高可用性保障，而push推荐给予较低可用性保障；<br>首页“猜你喜欢”和push推荐都需要很大的本地缓存，有较大的内存使用冲突，并且响应时间都很长，有严重的CPU使用冲突。<br>因此我们采取了如下措施，一方面，解决了首页“猜你喜欢”的可用性低问题，减少了未来出现可用性问题的概率，最终将其TP95响应时间降低了40%；另一方面也提高了其他推荐产品的服务可用性和高峰吞吐量。</p>
<p>将首页“猜你喜欢”推荐进行单独部署，而将push推荐和其他对系统资源要求不高的推荐部署在另一个集群上面；<br>对于新承接的推荐业务，新建一套代码，避免影响首页推荐这种最高可用性的业务。<br>缺点和优点<br>垂直分割主要的缺点主要有两个：</p>
<p>增加了维护成本。一方面代码库数量增多提高了开发工程师的维护成本，另一方面，部署集群的变多会增加运维工程师的工作量；<br>代码不共享所导致的重复编码工作。<br>解决重复编码工作问题的一个思路就是为不同的系统提供共享库（Shared Library），但是这种耦合反过来可能导致部署机器中引入未部署业务的开销。所以在共享库中要减少静态代码的初始化开销，并将类似缓存初始化等工作交给上层系统。总的来说，通过共享库的方式引入的开销可以得到控制。但是对于业务密集型的系统，由于业务往往是高度定制化的，共用一套代码库的好处是开发工程师可以采用Copy-on-write的模式进行开发，需要修改的时候随时拷贝并修改。共享库中应该存放不容易变化的代码，避免使用者频繁升级，所以并不适合这种场景。因此，对于业务密集型的系统，分代码所导致的重复编码量是需要权衡的一个因素。</p>
<p>垂直分割是一个非常简单而又有效的性能优化模式，特别适用于系统已经出现问题而又需要快速解决的场景。部署层次的分割既安全又有效。需要说明的是部署分割和简单意义上的加机器不是一回事，在大部分情况下，即使不增加机器，仅通过部署分割，系统整体吞吐量和可用性都有可能提升。所以就短期而言，这几乎是一个零成本方案。对于代码层次的分割，开发工程师需要在业务承接效率和系统可用性上面做一些折衷考虑。</p>
<p>恒变分离模式（Runtime 3NF Pattern）<br>原理和动机<br>基于性能的设计要求变化的数据和不变的数据分开，这一点和基于面向对象的设计原则相悖。在面向对象的设计中，为了便于对一个对象有整体的把握，紧密相关的数据集合往往被组装进一个类，存储在一个数据库表，即使有部分数据冗余（关于面向对象与性能冲突的讨论网上有很多文章，本文不细讲）。很多系统的主要工作是处理变化的数据，如果变化的数据和不变的数据被紧密组装在一起，系统对变化数据的操作将引入额外的开销。而如果易变数据占总数据比例非常小，这种额外开销将会通过杠杆效应恶化系统性能。分离易变和恒定不变的数据在对象创建、内存管理、网络传输等方面都有助于性能提高。</p>
<p>恒变分离模式的原理非常类似与数据库设计中的第三范式（3NF）：第三范式主要解决的是静态存储中重复存储的问题，而恒变分离模式解决的是系统动态运行时候恒定数据重复创建、传输、存储和处理的问题。按照3NF，如果一个数据表的每一记录都依赖于一些非主属性集合，而这些非主属性集合大量重复出现，那么应该考虑对被依赖的非主属性集合定义一个新的实体（构建一个新的数据表），原数据库的记录依赖于新实体的ID。如此一来数据库重复存储数据量将大大降低。类似的，按照恒变分离模式，对于一个实体，如果系统处理的只是这个实体的少量变化属性，应该将不变的属性定义为一个新实体（运行时的另一个类，数据库中的另一个表），原来实体通过ID来引用新实体，那么原有实体在运行系统中的数据传输、创建、网络开销都会大大降低。</p>
<p>案例分析<br>我们的挑战是提供一个高性能、高一致性要求的团购服务（DealService）。系统存在一些多次请求杠杆反模式问题，客户端一次请求会导致几十次DealService读取请求，每次获取上百个团购详情信息，服务端单机需要支持每秒万次级别的吞吐量。基于需求，系统大体框架设计如下：<br>恒变分离模式<br>每个DealService定期从持久层同步所有发生变化的deal信息，所有的deal信息保存在内存里面。在最初的设计里面，数据库只有一个数据表DealModelTable，程序里面也只有一个实体类DealModel。由于销量、价格、用户评价等信息的频发变化，为了达到高一致性要求，服务系统每分钟需要从数据库同步几万条记录。随着美团团购数量的增多和用户活跃度的增加，系统出现了三个问题：</p>
<p>团购服务网卡频繁报警，由于这是高性能低延时服务，又导致了大量的客户端超时异常；<br>频繁的full GC，这是由于每条数据库记录更新都会导致运行系统里面老的DealModel实体被销毁，新的DealModels实体被创建；<br>数据库从库滞后主库，使得服务数据一致性降低，原因是数据库系统写数据量巨大。<br>在对系统进行分析之后，我们采用了如下措施，大大降低了网络传输的数据量，缓解了主从数据库同步压力，使得客户端的超时异常从高峰时候的9%降低到了小于0.01%（低于万分之一）：</p>
<p>将DealModelTable中的销量、价格、用户评价等常变的信息单独构建一张数据表VariableDealModel；<br>同时在代码中为销量、价格、用户评价等常变数据创建一个单独的类VariableDealModel；<br>DealService对两张表进行分别同步；<br>如果DealModelTable的记录产生了更新，运行系统销毁老的DealModel实体并创建新的DealModel实体；<br>如果只是VariableDealModel的记录产生了更新，只对VariableDealModel的属性进行更改。<br>缺点和优点<br>采用恒变分离模式，主要有三个缺点：</p>
<p>不符合面向对象的设计原则。原本概念上统一的实体被切分成多个实体，会给开发工程师带来一些理解上的困难，因此增加维护成本。进一步而言，这会增加引入额外Bug的概率（实际上面向对象之所以如此受欢迎的一个重要原因就是容易理解）。<br>增加了类不变量（Class invariant）的维护难度。很多情况下，Class invariant是通过语言所提供的封装（Encapsulation）特性来维护的。当一个类变成多个类，Class invariant可能会被破坏。如果必须维护Class invariant，而这种Class invariant又发生在不同实体之间，那么往往是把不变的属性从不变实体移到易变的实体中去。<br>一张数据库表变成多张，也会增加维护成本。<br>在如下两种场景下，恒变分离模式所带来的好处有限：</p>
<p>易变数据导致的操作和传输并不频繁，不是系统主要操作；<br>易变数据占整体数据的比例很高，杠杆效应不显著，通过恒变分离模式不能根本性地解决系统性能问题。<br>总的来说，恒变分离模式非常容易理解，其应用往往需要满足两个条件：易变数据占整体数据比例很低（比例越低，杠杆效应越大）和易变数据所导致的操作又是系统的主要操作。在该场景下，如果系统性能已经出现问题，牺牲一些可维护性就显得物有所值。</p>
<p>大部分系统都是由多种类型的数据构成，大多数数据类型的都包含易变、少变和不变的属性。盲目地进行恒变分离会导致系统的复杂度指数级别的增加，系统变得很难维护，所以系统设计者必须在高性能和高维护性之间找到一个平衡点。作者的建议是：对于复杂的业务系统，尽量按照面向对象的原则进行设计，只有在性能出现问题的时候才开始考虑恒变分离模式；而对于高性能，业务简单的基础数据服务，恒变分离模式应该是设计之初的一个重要原则。</p>
<p>数据局部性模式（Locality Pattern）<br>原理和动机<br>数据局部性模式是多次请求杠杆反模式的针对性解决方案。在大数据和强调个性化服务的时代，一个服务消费几十种不同类型数据的现象非常常见，同时每一种类型的数据服务都有可能需要一个大的集群（多台机器）提供服务。这就意味着客户端的一次请求有可能会导致服务端成千上万次调用操作，很容易使系统进入多次请求杠杆反模式。在具体开发过程中，导致数据服务数量暴增的主要原因有两个：1. 缓存滥用以及缺乏规划，2. 数据量太大以至于无法在一台机器上提供全量数据服务。数据局部性模的核心思想是合理组织数据服务，减少服务调用次数。具体而言，可以从服务端和客户端两个方面进行优化。</p>
<p>服务端优化方案的手段是对服务进行重新规划。对于数据量太大以至于无法在一台机器上存储全量数据的场景，建议采用Bigtable或类似的解决方案提供数据服务。典型的Bigtable的实现包括Hbase、Google Cloud Bigtable等。实际上数据局部性是Bigtable的一个重要设计原则，其原理是通过Row key和Column key两个主键来对数据进行索引，并确保同一个Row key索引的所有数据都在一台服务器上面。通过这种数据组织方式，一次网络请求可以获取同一个Row key对应的多个Column key索引的数据。缺乏规划也是造成服务数量剧增的一个重要原因。很多通过统计和挖掘出来的特征数据往往是在漫长的时间里由不同team独立产生的。而对于每种类型数据，在其产生之初，由于不确定其实际效果以及生命周期，基于快速接入原则，服务提供者往往会用手头最容易实施的方案，例如采用Redis Cache（不加选择地使用缓存会导致缓存滥用）。数据服务之间缺乏联动以及缺乏标准接入规划流程就会导致数据服务数量膨胀。数据局部性原则对规划的要求，具体而言是指：1. 数据由尽可能少的服务器来提供，2. 经常被一起使用的数据尽可能放在同一台服务器上。</p>
<p>客户端优化有如下几个手段：</p>
<p>本地缓存，对于一致性要求不高且缓存命中率较高的数据服务，本地缓存可以减少服务端调用次数；<br>批处理，对于单机或者由等价的机器集群提供的数据服务，尽可能采用批处理方式，将多个请求合成在一个请求中；<br>客户端Hash，对于需要通过Hash将请求分配到不同数据服务机器的服务，尽量在客户端进行Hash，对于落入同一等价集群的请求采用批处理方式进行调用。<br>案例分析<br>我们的挑战来自于美团的推荐、个性化列表和个性化搜索服务。这些个性化系统需要获取各种用户、商家和团购信息。信息类型包括基本属性和统计属性。最初，不同属性数据由不同的服务提供，有些是RPC服务，有些是Redis服务，有些是HBase或者数据库，参见下图：<br>数据局部性模式1</p>
<p>通常而言，客户端每个用户请求都会触发多个算法。一方面，每个算法都会召回几十甚至几百个团购或者商家ID，团购和商家基础属性被均匀地分配到几十台Redis里面（如下图），产生了大量的Redis请求，极端情况下，一次客户端请求所触发的团购基础数据请求就超过了上千次；另一方面，用户特征属性信息有十几种，每种属性也由单独的服务提供，服务端网络调用次数暴增。在一段时间里，很多系统都进入了多次请求杠杆反模式，Redis服务器的网卡经常被打死，多次进行扩容，提高线程池线程数量，丝毫没有改善。<br>数据局部性模式2<br>在对系统进行分析之后，按照数据局部性模式的原则，我们采用了如下手段，彻底解决了系统多次请求杠杆反模式的问题：</p>
<p>采用大内存服务器存储所有的团购和商家基础信息，每个算法只要一次网络请求就可以获取所有的信息；<br>服务端采用多线程方式提供服务，避免了Redis单一线程模式下单个请求慢所带来的连锁效应；<br>借鉴类似Bigtable的数据组织方式，将用户的多种特征采用两个维度（用户维度和特征类型）进行索引，确保同一用户的信息只存放在一台机器上面，减少网络调用数量。<br>缺点和优点<br>数据局部性模式并不适用于系统初级阶段。在初级阶段，最小可用原则往往是主要设计原则之一，出于两方面的考虑：一方面，在初级阶段，很难预测所要提供服务的数据是否有效而且能够长期使用，以及未来的调用量；另一方面，在初级阶段，工程师可能无法预测最终的调用模式，而不同的调用模式会导致数据局部性方案的设计不同。对于已经大量使用的数据服务，采用数据局部性模式进行重构必然要改变老的调用模式，这一方面会引入新的Bug，另一方面也意味着巨大的工作量。需要特别强调的是，数据处于系统的最底层，对于结构复杂而又重要的数据，重构所带来可靠性、一致性和工作量都是需要权衡的因素。对于请求量比较小的数据服务，即使一次请求会触发严重的请求杠杆效应，但是如果原始触发请求数量在可预见的时间内没有明显变多的迹象，进行数据服务重构可能得不偿失。</p>
<p>数据局部性模式能够解决多次请求杠杆反模式所导致的问题，但它并非大数据的产物，CPU、编译器的设计理念里早就融入了该模式，所以很容易被工程师理解。虽然过度设计在系统初级阶段是一个要尽量避免的事情，但是理解和掌握数据局部性模式对于设计出一个可扩展、可重用的系统有很大帮助。很多成熟的系统因为多次请求杠杆反模式而导致系统频繁崩溃，理解数据局部性模式的原则有助于提高工程师分析解决问题的能力，而在确认了系统存在请求杠杆问题后，数据局部性原则是一件非常锐利的武器。</p>
<p>避免蚊子大炮模式（Avoiding Over-generalized Solution Pattern）<br>原理和动机<br>“用大炮打蚊子”本来是大材小用的意思，但是细致想一想，用大炮打蚊子，成功率不高。对于开发工程师而言，一方面为了快速承接业务，按照方案复用原则，总是尽可能地利用现有系统，这使得系统功能越来越强大；另一方面，提高系统的通用性或可重用性也是工程师们在设计系统的一个重要目标。随着这两个过程的相互独立演化，采用通用方案解决特定问题的现象随处可见，形象地说，这就像大炮打蚊子。大炮成本很高，蚊子的数量众多，最终的结局往往是蚊子战胜了大炮。</p>
<p>“避免蚊子大炮模式”是经济原则在运行时系统的运用，它要求采用最节省资源（CPU、内存等）的方法来解决所面临的问题，资源浪费会带来未来潜在的风险。工程师接到一个需求的时候，需要思考的不仅仅是如何复用现有的系统，减少开发时间，还需要考虑现有系统为处理每个新需求访问所需运行时成本，以及新需求的预期访问量。否则，不加辨别地利用现有系统，不仅仅增大了重构风险，还有可能交叉影响，对现有系统所支持的服务造成影响。从另外一个角度讲，工程师在构建一个可重用系统的时候，要明确其所不能解决和不建议解决的问题，而对于不建议解决的问题，在文档中标明潜在的风险。</p>
<p>案例分析<br>我们的挑战是为移动用户寻找其所在位置附近的商家信息。美团有非常完善的搜索系统，也有资深的搜索工程师，所以一个系统需要查找附近的商家的时候，往往第一方案就是调用搜索服务。但是在美团，太多的服务有基于LBS的查询需求，导致搜索请求量直线上升，这本来不属于搜索的主营业务，在一段时间里面反倒成了搜索的最多请求来源。而搜索引擎在如何从几十万商家里面找最近的几百商家方面的性能非常差，因此一段时间里，搜索服务频繁报警。不仅仅搜索服务可用性受到了影响，所有依赖于LBS的服务的可用性都大大降低。</p>
<p>在对系统分析之后，我们认为更适合解决最短直线距离的算法应该是k-d tree，在快速实现了基于k-d tree的LBS Search解决方案之后，我们用4台服务器轻松解决了30多台搜索服务器无法解决的问题，平均响应时间从高峰时的100ms降低到300ns，性能取得了几百倍的提高。</p>
<p>缺点和优点<br>避免蚊子大炮模式的问题和数据局部性模式类似，都与最小可用原则相冲突。在系统设计初级阶段，寻求最优方案往往意味着过度设计，整个项目在时间和成本变得不可控，而为每个问题去找最优秀的解决方案是不现实的奢求。最优化原则的要求是全面的，不仅仅要考虑的运行时资源，还需要考虑工程师资源和时间成本等，而这些点往往相互矛盾。在如下情况下，避免蚊子大炮模式所带来的好处有限：在可预见的未来，某个业务请求量非常小，这时候花大量精力去找最优技术方案效果不明显。</p>
<p>在设计阶段，避免蚊子大炮模式是一个需要工程师去权衡的选择，需要在开发成本和系统运行成本之间保持一个平衡点。当很多功能融入到一个通用系统里而出现性能问题的时候，要拆分出来每一个功能点所造成的影响也不是件轻易的事情，所以采用分开部署而共用代码库的原则可以快速定位问题，然后有针对性地解决“蚊子大炮”问题。总的来说，在设计阶段，避免蚊子大炮模式是工程师们进行分析和设计的一个重要准则，工程师可以暂时不解决潜在的问题，但是一定要清楚潜在的危害。构建可重用系统或方案，一定要明确其所不能解决和不建议解决的问题，避免过度使用。</p>
<p>实时离线分离模式（Sandbox Pattern）<br>原理和动机<br>本模式的极端要求是：离线服务永远不要调用实时服务。该模式比较简单也容易理解，但是，严格地讲它不是一种系统设计模式，而是一种管理规范。离线服务和在线服务从可用性、可靠性、一致性的要求上完全不同。原则上，工程师在编写离线服务代码的时候，应该遵循的就是离线服务编程规范，按照在线服务编程规范要求，成本就会大大提高，不符合经济原则；从另外一方面讲，按照离线服务的需求去写在线服务代码，可用性、可靠性、一致性等往往得不到满足。</p>
<p>具体而言，实时离线分离模式建议如下几种规范：</p>
<p>如果离线程序需要访问在线服务，应该给离线程序单独部署一套服务；<br>类似于MapReduce的云端多进程离线程序禁止直接访问在线服务；<br>分布式系统永远不要直接写传统的DBMS。<br>案例分析<br>因为违反实时离线分离模式而导致的事故非常常见。有一次，因为一个离线程序频繁的向Tair集群写数据，每一次写10M数据，使得整个Tair集群宕机。另一次，因为Storm系统直接写MySQL数据库导致数据库连接数耗尽，从而使在线系统无法连接数据库。</p>
<p>缺点和优点<br>为了实现实时在线分离，可能需要为在线环境和离线环境单独部署，维护多套环境所带来运维成本是工程师需要考虑的问题。另一方面，在线环境的数据在离线环境中可能很难获取，这也是很多离线系统直接访问在线系统的原因。但是，遵从实时离线分离模式是一个非常重要的安全管理准则，任何违背这个准则的行为都意味着系统性安全漏洞，都会增大线上故障概率。</p>
<p>降级模式（Degradation Pattern）<br>原理和动机<br>降级模式是系统性能保障的最后一道防线。理论上讲，不存在绝对没有漏洞的系统，或者说，最好的安全措施就是为处于崩溃状态的系统提供预案。从系统性能优化的角度来讲，不管系统设计地多么完善，总会有一些意料之外的情况会导致系统性能恶化，最终可能导致崩溃，所以对于要求高可用性的服务，在系统设计之初，就必须做好降级设计。根据作者的经验，良好的降级方案应该包含如下措施：</p>
<p>在设计阶段，确定系统的开始恶化数值指标（例如：响应时间，内存使用量）；<br>当系统开始恶化时，需要第一时间报警；<br>在收到报警后，或者人工手动控制系统进入降级状态，或者编写一个智能程序让系统自动降级；<br>区分系统所依赖服务的必要性，一般分为：必要服务和可选服务。必要服务在降级状态下需要提供一个快速返回结果的权宜方案（缓存是常见的一种方案），而对于可选服务，在降级时系统果断不调用；<br>在系统远离恶化情况时，需要人工恢复，或者智能程序自动升级。<br>典型的降级策略有三种：流量降级、效果降级和功能性降级。流量降级是指当通过主动拒绝处理部分流量的方式让系统正常服务未降级的流量，这会造成部分用户服务不可用；效果降级表现为服务质量的降级，即在流量高峰时期用相对低质量、低延时的服务来替换高质量、高延时的服务，保障所有用户的服务可用性；功能性降级也表现为服务质量的降级，指的是通过减少功能的方式来提高用户的服务可用性。效果降级和功能性降级比较接近，效果降级强调的是主功能服务质量的下降，功能性降级更多强调的是辅助性功能的缺失。做一个类比如下：计划将100个工程师从北京送到夏威夷度假，但是预算不够。采用流量降级策略，只有50工程师做头等舱去了夏威夷度假，其余工程师继续编写程序（这可不好）；效果降级策略下，100个工程师都坐经济舱去夏威夷；采用功能性降级策略，100个工程师都坐头等舱去夏威夷，但是飞机上不提供食品和饮料。</p>
<p>案例分析<br>我们的系统大量使用了智能降级程序。在系统恶化的时候，智能降级程序自动降级部分流量，当系统恢复的时候，智能降级程序自动升级为正常状态。在采用智能降级程序之前，因为系统降级问题，整体系统不可用的情况偶尔发生。采用智能降级程序之后，基本上没有因为性能问题而导致的系统整体不可用。我们的智能降级程序的主要判定策略是服务响应时间，如果出现大量长时间的响应异常或超时异常，系统就会走降级流程，如果异常数量变少，系统就会自动恢复。</p>
<p>缺点和优点<br>为了使系统具备降级功能，需要撰写大量的代码，而降级代码往往比正常业务代码更难写，更容易出错，所以并不符合奥卡姆剃刀原则。在确定使用降级模式的前提下，工程师需要权衡这三种降级策略的利弊。大多数面向C端的系统倾向于采用效果降级和功能性降级策略，但是有些功能性模块（比如下单功能）是不能进行效果和功能性降级的，只能采用流量降级策略。对于不能接受降级后果的系统，必须要通过其他方式来提高系统的可用性。</p>
<p>总的来说，降级模式是一种设计安全准则，任何高可用性要求的服务，必须要按照降级模式的准则去设计。对于违背这条设计原则的系统，或早或晚，系统总会因为某些问题导致崩溃而降低可用性。不过，降级模式并非不需要成本，也不符合最小可用原则，所以对于处于MVP阶段的系统，或者对于可用性要求不高的系统，降级模式并非必须采纳的原则。</p>
<p>其他性能优化建议<br>对于无法采用系统性的模式方式讲解的性能优化手段，作者也给出一些总结性的建议：</p>
<p>删除无用代码有时候可以解决性能问题，例如：有些代码已经不再被调用但是可能被初始化，甚至占有大量内存；有些代码虽然在调用但是对于业务而言已经无用，这种调用占用CPU资源。<br>避免跨机房调用，跨机房调用经常成为系统的性能瓶颈，特别是那些伪batch调用（在使用者看起来是一次性调用，但是内部实现采用的是顺序单个调用模式）对系统性能影响往往非常巨大<br>。<br>总结<br>Christopher Alexander曾说过：”Each pattern describes a problem which occurs over and over again in our environment, and then describes the core of the solution to that problem, in such a way that you can use this solution a million times over, without ever doing it the same way twice” 。 尽管Christopher Alexander指的是建筑模式，软件设计模式适用，基于同样的原因，性能优化模式也适用。每个性能优化模式描述的都是工程师们日常工作中经常出现的问题，一个性能优化模式可以解决确定场景下的某一类型的问题。所以要理解一个性能优化模式不仅仅要了解性能模式的所能解决的问题以及解决手段，还需要清楚该问题所发生的场景和需要付出的代价。</p>
<p>最后，本文所描述的性能优化模式只是作者的工作经验总结，都是为了解决由以下三种情况所造成的性能问题：1. 日益增长的用户数量，2. 日渐复杂的业务，3. 急剧膨胀的数据，但是这些远非该领域里面的所有模式。对于文章中提到的其他性能优化建议，以及现在和将来可能碰到的性能问题，作者还会不断抽象，在未来总结出更多的模式。性能问题涉及领域非常广泛，而模式是一个非常好的讲解性能问题以及解决方案的方式，作者有理由相信，无论是在作者所从事的工作领域里面还是在其他的领域里面，新的性能优化模式会不断涌现。希望通过本文的讲述，对碰到同样问题的工程师们有所帮助，同时也抛砖引玉，期待出现更多的基于模式方式讲解性能优化的文章。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/10/performance-tuning-pattern/" data-id="cj4quikwr000une5stfssc83d" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-dropbox-shadowsocks" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/04/dropbox-shadowsocks/" class="article-date">
  <time datetime="2015-12-04T09:11:18.000Z" itemprop="datePublished">2015-12-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vps/">Vps</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/04/dropbox-shadowsocks/">Dropbox配合Shadowsocks Vps配置实时同步</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>为什么选择Dropbox？</p>
<p>链接：<a href="http://www.zhihu.com/question/19646859/answer/14707821" target="_blank" rel="external">http://www.zhihu.com/question/19646859/answer/14707821</a></p>
<h4 id="非常稳定"><a href="#非常稳定" class="headerlink" title="非常稳定"></a>非常稳定</h4><pre><code>程序稳定不出现错误和崩溃。速度稳定，连接服务器一直很稳定。这一点很赞，不像国内的一些网盘经常莫名其妙的崩溃。
</code></pre><h4 id="安全保障"><a href="#安全保障" class="headerlink" title="安全保障"></a>安全保障</h4><pre><code>国内的网盘同步工具很容易因为运营不善挂掉，而Dropbox从08年开始创建，运营一直良好，现在估值大概40亿美刀。公司实力雄厚，不用担心突然挂掉。
</code></pre><h4 id="多平台云同步"><a href="#多平台云同步" class="headerlink" title="多平台云同步"></a>多平台云同步</h4><pre><code>Dropbox是最早支持也是覆盖最全面各大平台的，而其他的软件做不到。我一般在家里和公司使用，偶尔手机使用。
</code></pre><h4 id="版本控制"><a href="#版本控制" class="headerlink" title="版本控制"></a>版本控制</h4><pre><code>应该是dropbox很大的一个特色，免费用户可以回溯30天的版本。非常贴心的功能，尤其是对于存储重要工作文档的用户。
</code></pre><h4 id="增量同步"><a href="#增量同步" class="headerlink" title="增量同步"></a>增量同步</h4><pre><code>当用户Dropbox文件夹中的文件发生变化后，Dropbox只上传改变的文件部分，并实施同步。所以dropbox的同步速度很棒。
</code></pre><h4 id="简洁无干扰"><a href="#简洁无干扰" class="headerlink" title="简洁无干扰"></a>简洁无干扰</h4><pre><code>Dropbox安装好之后就静静在后台处理，不会干扰用户的任何工作。而不像国内其他软件老是主动弹出干扰。另外没有任何广告非常贴心啊！！
</code></pre><h4 id="外链分享"><a href="#外链分享" class="headerlink" title="外链分享"></a>外链分享</h4><pre><code>非常方便的分享规则，只需要右键点击文件和文件夹就可以任意分享。
</code></pre><h4 id="协同工作"><a href="#协同工作" class="headerlink" title="协同工作"></a>协同工作</h4><pre><code>可以设定一个文件夹供多人一起协作，我一直用这个功能和同事共享文档和同步工作内容。
</code></pre><h4 id="丰富的API"><a href="#丰富的API" class="headerlink" title="丰富的API"></a>丰富的API</h4><pre><code>利用Dropbox提供的API有很多强大的功能，比如把重要的Gmail附件自动备份到Dropbox，比如备份Facebook的加星照片，比如自动定期备份网站源文件到Dropbox。
</code></pre><h4 id="Dropbox支持Socks5"><a href="#Dropbox支持Socks5" class="headerlink" title="Dropbox支持Socks5"></a>Dropbox支持Socks5</h4><p><img src="http://cdn.bestxiaoyu.com/images/QQ20151204-0@2x.png" alt=""><br><img src="http://cdn.bestxiaoyu.com/images/QQ20151204-1@2x.png" alt=""></p>
<hr>
<blockquote>
<p>微信扫一扫，请博主喝杯咖啡.<br><img src="http://cdn.bestxiaoyu.com/images%2Fcoffee.png?imageView2/1/w/200/h/200/q/75" alt="微信扫一扫，请博主喝杯咖啡."></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/04/dropbox-shadowsocks/" data-id="cj4quikvy0005ne5srk5klb3l" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dropbox/">Dropbox</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Shadowsocks/">Shadowsocks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vps/">Vps</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-vultr-shdowsocks-Debian" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/03/vultr-shdowsocks-Debian/" class="article-date">
  <time datetime="2015-12-03T09:11:27.000Z" itemprop="datePublished">2015-12-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vps/">Vps</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/03/vultr-shdowsocks-Debian/">Vps Vultr Debian系统搭建Shadowsocks</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="2016-02-24更新"><a href="#2016-02-24更新" class="headerlink" title="2016-02-24更新"></a>2016-02-24更新</h3><p>锐速宣布停止运营  新VPS无法再安装锐速</p>
<h3 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h3><p><a href="https://www.vultr.com/freetrial/" target="_blank" rel="external">https://www.vultr.com/freetrial/</a> 这个url注册账户 送50刀 有效期2个月</p>
<h3 id="部署VPS"><a href="#部署VPS" class="headerlink" title="部署VPS"></a>部署VPS</h3><p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-9@2x.png" alt=""></p>
<p>ssd硬盘</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-10@2x.png" alt=""><br>日本节点每月流量会变少<br>debian系统 (为什么选择debian? 可以完美开启锐速)<br>锐速支持服务器列表:<a href="http://dl.serverspeeder.com/ls.do?m=availables" target="_blank" rel="external">http://dl.serverspeeder.com/ls.do?m=availables</a><br>Server Size根据自身条件选择 如果赠送到50刀两月的同学 可以选择2CPU 2048MEMORY的 到期后再改就行了</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-11@2x.png" alt=""></p>
<p>Server Label随便填吧<br>填好之后 Place Order.</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-12@2x.png" alt=""></p>
<h3 id="正在安装。。。。。"><a href="#正在安装。。。。。" class="headerlink" title="正在安装。。。。。"></a>正在安装。。。。。</h3><p>可能需要刷新页面</p>
<p>如果状态显示Running 点击Manage</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-13@2x.png" alt=""></p>
<p>终端或者putty或者其他工具ssh服务器</p>
<p>ssh root@{服务器地址}  ssh root@xx.xx.xx.xx</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-0@2x.png" alt=""></p>
<h3 id="依次执行以下命令"><a href="#依次执行以下命令" class="headerlink" title="依次执行以下命令:"></a>依次执行以下命令:</h3><p>wget –no-check-certificate <a href="https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh" target="_blank" rel="external">https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</a><br>chmod +x shadowsocks.sh<br>./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-1@2x.png" alt=""></p>
<p>根据提示输入shadowsocks密码 及 端口号</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-2@2x.png" alt=""></p>
<p>出现这一步  则代表安装成功了</p>
<p>####锐速宣布停止运营  新VPS无法再安装锐速<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">### 开启锐速</div><div class="line">首先注册一个锐速账号:http://my.serverspeeder.com/</div><div class="line">依次执行以下命令:</div><div class="line">wget http://my.serverspeeder.com/d/ls/serverSpeederInstaller.tar.gz</div><div class="line">tar xzvf serverSpeederInstaller.tar.gz</div><div class="line">bash serverSpeederInstaller.sh</div><div class="line"></div><div class="line"></div><div class="line">### 最后在终端输入</div><div class="line"></div><div class="line">nano /serverspeeder/etc/config</div><div class="line"></div><div class="line">确保advinacc=1 maxmode=1 rsc=1</div><div class="line"></div><div class="line">### 重启锐速</div><div class="line">/serverspeeder/bin/serverSpeeder.sh restart</div></pre></td></tr></table></figure></p>
<h3 id="下载-Shadowsocks客户端"><a href="#下载-Shadowsocks客户端" class="headerlink" title="下载(Shadowsocks客户端)"></a>下载(Shadowsocks客户端)</h3><p>按自己的shadowsocks配置开始配置</p>
<p><img src="http://cdn.bestxiaoyu.com/images/QQ20151203-8@2x.png" alt=""></p>
<p>chrome为长连接  配置好之后选择全局模式 可以访问google啦</p>
<p>后面会写下chrome的自动代理配合shadowsocks翻*墙。</p>
<hr>
<blockquote>
<p>微信扫一扫，请博主喝杯咖啡.<br><img src="http://cdn.bestxiaoyu.com/images%2Fcoffee.png?imageView2/1/w/200/h/200/q/75" alt="微信扫一扫，请博主喝杯咖啡."></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/03/vultr-shdowsocks-Debian/" data-id="cj4quikxf001jne5sclnsgfry" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Debian/">Debian</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Shadowsocks/">Shadowsocks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vps/">Vps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vultr/">Vultr</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hacking" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/03/hacking/" class="article-date">
  <time datetime="2015-12-02T16:00:00.000Z" itemprop="datePublished">2015-12-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/03/hacking/">黑客高手讲述入侵实践经验</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>无论什么站，无论什么语言，我要渗透，第一件事就是扫目录，最好一下扫出个上传点，直接上传 shell ，诸位不要笑，有时候你花很久搞一个站，最后发现有个现成的上传点，而且很容易猜到，不过这种情况发生在 asp 居多！</p>
<ol>
<li><p>无论什么站，无论什么语言，我要渗透，第一件事就是扫目录，最好一下扫出个上传点，直接上传 shell ，诸位不要笑，有时候你花很久搞一个站，最后发现有个现成的上传点，而且很容易猜到，不过这种情况发生在 asp 居多！</p>
</li>
<li><p>asp （ aspx ）+MSSQL 先考虑注入，一般的注入都有 DBowner 权限可以直接写 shell ；如果写不了，或者 web 与数据库分离，那就猜数据，从后台下手了，后台可以上传或者改配置文件；</p>
</li>
<li><p>asp （ aspx ）+ACCESS 拿 shell 一般只有 3 种方法，一是前台上传或者注入进后台上传；二是注入进后台改配置文件；三是注入进后台备份数据库或者暴库后知道是 asp 或者 asa 数据库于是直接写一句话；</p>
</li>
<li><p>php+MYSQL 一般是注入进后台上传，偶尔运气好些权限够高可以注入 select into outfile ；然后包含，分本地与远程，远程包含在高版本 php 是不支持的，于是想办法本地上传图片文件或者写到 log 里；然后 php 程序某某未公开的漏洞，运气好可以直接写 shell 。</p>
</li>
<li><p>jsp+MYSQL 利用数据库拿权限方面基本同 php ，而且 jsp 的上传基本很少检查文件后缀，于是只要有注入点与后台，拿 shell 相当的容易。 jsp+ORACLE 的站我碰到的不多，碰到的也是猜出用户名与密码从后台下手的。</p>
</li>
<li><p>无论什么大站，主站一般都很安全（不然早被人玩了），于是一般从二级域名下手，猜出主站的某些用户名与密码或者搞到主站的源代码，或者旁注得到同网段服务器后 cain 或 arp 。</p>
</li>
<li><p>一般的大站很少有用现成的 CMS 的，于是如果你有幸找到源码，那你就发了，注入漏洞啊，上传漏洞啊，写文件漏洞啊，都掌握在你手里。多看看那些大站新出来的测试分站点，那些站还在测试中，可以很轻松拿下。</p>
</li>
<li><p>上传有个文件名截断，这包括 2 个方面，一是 00 截断，二是长文件名截断（曾经利用这个搞下 hw ）；然后很多写文件的地方，都可以 00 ，屡试不爽。上传别忘了.asp （当然.asa ，.cer ，.cdx 都可以啦）目录的妙用。</p>
</li>
<li><p>php 站无论 windows 还是 linux ，都有 magic_quotes_gpc 的问题， magic_quotes_gpc 为 on 的时候，在 server 变量注入的时候还是可以 select into outfile ，今年我搞过某未开源 cms 就是这个情况，一般情况下为 on 就别考虑写文件了，不过有这个权限别忘了读文件源码，因为 load_file 的参数是可以编码的。</p>
</li>
<li><p>猜路径或者文件在入侵中非常必要，猜不到路径的时候别忘了 google （ baidu 太烂， google 很全），于是你可以考虑看站点下的 robot.txt 或者 robots.txt ，会有惊喜。</p>
</li>
<li><p>工具的使用很重要，入侵之前用 WVS 扫扫会有助入侵；注入工具虽然很多，但不见得都好使，现在的软硬防火墙、防注入越来越厉害，那时候你就别偷懒，多手工有助你成长。</p>
</li>
<li><p>遇到过一流监控么，遇到其他防 post 的防火墙么，有时候一句话进去了都无法传大马，那时候，你先学学编码，学学变换绕过。</p>
</li>
<li><p>想搞一般的小站，记得查看这个小站的版权，找做这个站的公司，然后从这个公司做的其他站下手，得到源码再回头搞，我曾经通过这个方法拿下某知名制药的公司站。</p>
</li>
<li><p>旁注的思路永远不过时，遇到 dbowner 的注入，可以很舒服写 shell 到你需要的站，省得麻烦的提权了；运气不好，按部就班拿 shell 提权得到你所需。</p>
</li>
<li><p>永远别忘记社会工程学，利用社工把自己当成一个什么也不会的人，从某某站长的 qq ，身份证，邮箱等等下手，也许有时可能会有意外；另外别忘记 admin,admin ； test,test ； 123456,123456 这种简单的尝试，当然，你也可以暴力破解。</p>
</li>
<li><p>别忽视 XSS ，别忽视 cookie ， XSS 可以偷 cookie ，更有若干妙用，自己学会领悟； cookie 可以伪造登陆， cookie 可以注入， cookie 注入可以绕绝大多数的防火墙。</p>
</li>
<li><p>平时搞站多多搜集路径啊，源码啊，工具啊，充实自己的“武器”库；最好把自己的入侵步骤记录下来，或者事后反思下，我一般都是记在 txt 里，另外要做到举一反三。</p>
</li>
<li><p>到 GoogLe,搜索一些关键字,edit.asp? 韩国肉鸡为多,多数为 MSSQL 数据库!</p>
</li>
<li><p>到 Google ,site:cq.cn inurl:asp</p>
</li>
<li><p>利用挖掘鸡和一个 ASP 木马. 文件名是 login.asp 路径组是 /manage/ 关键词是 went.asp 用’or’=’or’来登陆</p>
</li>
<li><p>关键字： Co Net MIB Ver 1.0 网站后台管理系统帐号密码为 ‘or’=’or’</p>
</li>
<li><p>动感购物系统 inurl:help.asp 登陆，如未注册成为会员! upLoad_bm1.asp 和 upLoad_c1.asp 这两个随便选个，一般管理员都忽视了这 2 漏洞</p>
</li>
<li><p>默认数据库地址 blogdata/acblog.asa 关键字： acblog</p>
</li>
<li><p>百度 /htdocs 注册里可以直接上传 asa 文件！</p>
</li>
<li><p>/Database/#newasp.mdb 关键词： NewAsp SiteManageSystem Version</p>
</li>
<li><p>用挖掘机 关键字： Powered by WEBBOY 页面：/upfile.asp</p>
</li>
<li><p>baidu 中搜索关键字 Ver5.0 Build 0519 (存在上传漏洞)</p>
</li>
<li><p>Upfile_Article.asp bbs/upfile.asp 输入关键字： powered by mypower ，</p>
</li>
<li><p>inurl:winnt\system32\inetsrv\ 在 google 里面输入这个就可以找到很多网站</p>
</li>
<li><p>现在 GOOGLE 搜索关键字 intitle:网站小助手　 inurl:asp</p>
</li>
<li><p>键字： 首页 最新动态 新手指南 舞曲音乐 下载中心 经典文章 玩家风采 装备购买 站内流言 友情连接 本站论坛挖掘鸡的关键字 添 setup.asp</p>
</li>
<li><p>VBulletin 论坛的数据库默认数据库地址! /includes/functions.php 工具: 1.网站猎手 下载地址:百度 Google! 2.Google 关键字: Powered by: vBulletin Version 3.0.1 Powered by: vBulletin Version 3.0.2 Powered by: vBulletin Version 3.0.3 其中一个就可以了</p>
</li>
<li><p>1.打开百度或 GOOGLE 搜索，输入 powered by comersus ASP shopping cart open source 。 这是一个商场系统。 2.网站的最底部分，有个 Comersus Open Technologies LC 。打开看下~~comersus 系统~ 猜到,comersus.mdb. 是数据库名数据库都是放在 database/ 后的, 所以 database/comersus.mdb comersus_listCategoriesTree.asp 换成 database/comersus.mdb ，不能下载。那样把前一个 ‘’store/‘’除去，再加上 database/comersus.mdb 试试</p>
</li>
<li><p>无忧传奇官方站点程序。 1.后台管理地址： <a href="http://您的域名" target="_blank" rel="external">http://您的域名</a> /msmiradmin/ 2.默认后台管理帐号： msmir 3.默认后台管理密码： msmirmsmir 数据库文件为 <a href="http://您的域名" target="_blank" rel="external">http://您的域名</a> /msmirdata/msmirArticle.mdb 数据库连接文件为 <strong><strong><em>*</em></strong></strong>/Conn.asp</p>
</li>
<li><p>百度里输入 /skins/default/</p>
</li>
<li><p>利用挖掘机关键机:power by Discuz 路径:/wish.php 配合: Discuz!论坛 wish.php 远程包含漏洞 工具使用</p>
</li>
<li><p>上传漏洞. 工具 : Domain3.5 网站猎手 1.5 版关键字 powered by mypower 检测的页面或文件插入 upfile_photo.asp</p>
</li>
<li><p>新云漏洞这个漏洞 ACCESS 和 SQL 版通吃。 Google 搜索关键字 “关于本站 - 网站帮助 - 广告合作 - 下载声明 - 友情连接 - 网站地图 - 管理登录” 把 flash/downfile.asp?url=uploadfile/../../conn.asp 提交到网站根目录。就可以下载 conn.asp 以源码，软件等下载站居多。大家时常碰到数据库如果前面或者中间+了# 可以用%23 替换就可以下载了 \database\%23newasp.mdb 如：#xzws.mdb 改成%23xzws.mdb</p>
</li>
<li><p>通吃所有商城+动力上传系统使用工具:挖掘鸡 v1.1 明小子商城入侵: 关键字:选购-&gt;加入购物车-&gt;去收银台-&gt;确认收货人信息-&gt;选付款方式-&gt;选配送方式-&gt;在线支付或下单后汇款 -&gt;汇款确认-&gt;发货-&gt;完成漏洞页面:upload.asp upfile_flash.asp 动力入侵: 关键字:powered by mypower 漏洞页面:upfile_photo.asp Upfile_Soft.asp upfile_adpic.asp upfile_softpic.asp</p>
</li>
<li><p>动易列目录 admin_articlerecyclebin.asp inurl:admin_articlerecyclebin.asp</p>
</li>
<li><p>工具:网站猎手关键词:inurl:Went.asp 后缀:manage/login.asp 口令:’or’=’or’</p>
</li>
<li><p>入侵魔兽私服需要的工具： ASP 木马一只。 Domain3.5 明小子关键字： All Right Reserved Design:游戏联盟后台地址： admin/login.asp 数据库的地址： chngame/#chngame.mdb</p>
</li>
<li><p>漏洞是利用管理员 iis 设置的失误用 baidu 关键字就是比较罕见的脚本名动网: ReloadForumCache.asp Leadbbs: makealltopanc.asp BBSXP: admin_fso.asp 动易: admin_articlerecyclebin.asp</p>
</li>
<li><p>国外站的爆库漏洞关键字： sad Raven’s Guestbook 密码地址:/passwd.dat 后台地址:/admin.php</p>
</li>
<li><p>关键字：尚奈克斯后台路径 /system/manage.asp 直接传 ASP 木马</p>
</li>
<li><p>工具 1:网站猎手 2:大马一个关键字:切勿关闭 Cookies 功能，否则您将不能登录插入 diy.asp</p>
</li>
<li><p>关键字:Team5 Studio All rights reserved 默认数据库:data/team.mdb</p>
</li>
<li><p>工具: 挖掘机 辅臣数据库读取器关键字: 企业简介 产品展示 产品列表后缀添加: /database/myszw.mdb 后台地址: admin/Login.asp</p>
</li>
<li><p>关键子 XXX inurl:Nclass.asp 在”系统设置”里写个木马。会被保存到 在 config.asp 内。</p>
</li>
<li><p>不进后台照样拿动网 WEBSHELL data.asp?action=BackupData 动网数据库备份默认路径 36. 工具:网站猎手 WebShell 关键字:inurl:Went.asp 后缀:manage/login.asp 弱口令:’or’=’or’</p>
</li>
<li><p>入侵雷池新闻发布系统关键字:leichinews 去掉 leichinews 后面的. 打上:admin/uploadPic.asp?actionType=mod&amp;picName=xuanran.asp 再上传马….. 进访问 uppic anran.asp 登陆马.</p>
</li>
<li><p>一、通过 GOOGLE 搜索找大量注入点关键字： asp?id=1 gov.jp/ asp?id= 页数： 100 语言：想入侵哪个国家就填什么语言吧</p>
</li>
<li><p>关键字： Powered by:94KKBBS 2005 利用密码找回功能 找回 admin 提问:ddddd 回答:ddddd</p>
</li>
<li><p>关键字:<strong>**</strong> inurl:readnews.asp 把最后一个 /改成%5c ,直接暴库,看密码,进后台随便添加个新闻 在标题输入我们的一句话木马</p>
</li>
<li><p>工具:一句话木马 BBsXp 5.0 sp1 管理员猜解器关键词:powered by bbsxp5.00 进后台,备份一句话马!</p>
</li>
<li><p>关键字：程序核心： BJXSHOP 网上开店专家 后台:/admin</p>
</li>
</ol>
<font color="gray">&lt;转V2EX&gt;</font>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/03/hacking/" data-id="cj4quikw20008ne5soovaacul" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/安全/">安全</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/黑客/">黑客</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-meeting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/30/meeting/" class="article-date">
  <time datetime="2015-11-30T09:11:46.000Z" itemprop="datePublished">2015-11-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Work/">Work</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/30/meeting/">我的开会法则</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&lt;转:道哥的黑板报&gt;<br>在2010年的夏天，我有幸作为集团工程师的代表之一和马云一起共进午餐 — 吃盒饭。当时是提前一天通知我过去蹭饭的，所以也没有准备类似「中国商业的未来在哪里」之类的高大上的问题。我记得我当时问了一个问题，觉得现在公司会议太多，而且效率很低，问他有没有什么办法？</p>
<p>马云和一众老板们都深以为然。当时他给出了个招，准备一个闹钟放在会议室里，定好时间，时间一到准时散会，绝不拖堂。</p>
<p>这招听起来就不怎么靠谱，不解决问题，也没见人用过，感觉是个歪招，所以后来我也就一直没有实行。</p>
<p>这么多年下来，我的会更多了，倒不是因为效率变低，而是现在的工作内容已经不仅仅是做技术，是带领了一块业务，我没法让自己闲下来。</p>
<p>今年4月份我去Facebook参观的时候，听说他们的工程师有一个「No Meeting Day」，每周有一天可以拒绝开会（特别紧急的除外）。当时我听了就觉得特别好，回来就想推行。结果回来很兴奋的和工程师们一说后，发现真正一线的研发工程师每周的会也不是特别的多，用处不大。而真正需要减负的是在一线主管和经理们的身上，但他们的会议一般又很难推掉，所以这招也不是很实用。</p>
<p>既然会议不可避免，那就想想怎么高效的开会吧，在这一点上，我现在已经颇有心得了。</p>
<p>高效开会的前提是纪律。开会时请务必保证每个人都全身心参与，否则就是在浪费大家的时间。因此我主持的会议，有两条很严格的规定，一是最多只允许开两台电脑，一台是做会议纪要的，一台是投胶片的主讲人用的，其他人的电脑一律不许开；二是不允许接听电话，如果有很重要的电话非接不可，那就先主动交罚款后再接听。</p>
<p>以往我参加一些会议，很多时候一进会议室就发现每个人桌子上都开着一台电脑，这样的会议基本上都是在扯淡。因为只要仔细观察，就会发现开会时这些人要么是在用IM聊天，要么就是在处理邮件，反正不是在开会。本来10分钟能解决的会议，都能拖成一个小时。所以我一般会要求所有人把电脑合上，没有东西分散注意力了，就逼着大家都把精力花在会议讨论的问题上，一般会议都能很快结束。</p>
<p>另外一种很恶劣的情况是大家不玩电脑了，都开始玩手机。这种现象现在也比比皆是。所以如果要做的更好一点，应该要求大家把手机都掏出来，摆在桌子上，也都别玩了，有谁想捡起来玩还会特别显眼。</p>
<p>在会议过程中接听电话也是我很痛恨的，一般会打断整个会议的进程，让所有人都停下来等他，这是在浪费所有人的时间。所以我会要求会议过程中不允许接听电话，如果真出了天大的事情要接，就先交罚款（一般被用来买水果）再接，以示对大家的尊重和补偿。</p>
<p>也因此，在我经常挂断别人的电话，也包括老板的。</p>
<p>除了这些简单的措施外，在会议中能收能放才是最重要的，这就看每个人的功底了。</p>
<p>每场会议都应该有一个重要的角色能够主导会议的走向，一般是会议主持人或者关键决策人。他要能够在关键的时候或收或放，打断没有重点的废话或过度的发散，或是让关键的人出来充分的表达观点，或是随时把需要加入的关键人员从外面拽进会议。总之，是尽一切可能把会议引导向高效决策的方向。</p>
<p>会议主持人要能及时打断所有开小会的人，一旦发现有人在交头接耳，要毫不犹豫的禁止。开小会无异于走神。在一个会议上，有事情应该讲出来让所有人参与讨论和发表意见，如果真有私下里要说的，可以会后再单独谈，一定不要用交头接耳的方式，这也属于浪费所有人的时间。</p>
<p>开会是为了做出决策，在很多时候不应该发散性的讨论问题，那是会前应该做好的准备工作。头脑风暴一类的会议，看似很好，实际上漫无目的，很容易过于发散，最后没有结论。开过几次头脑风暴类的会议而没有结论后，很容易把大家都开伤，再也不敢开会了。</p>
<p>马云前不久在组织部大会上讲，他进会议室前一般只有两种状态，一种是心里已经有了答案，只是来听听大家的意见；另一种是心里没有答案，来听听大家的想法和讨论。后一种会议，基本上进会议室时是什么状态，出来的时候还是什么状态。</p>
<p>开会的另一个目的，是为了达到充分的沟通。因此学会聆听很重要。我们每个人往往都急于表达自己的观点，说服他人而不是被他人说服。如果有人把想法憋在心里不说出来，不沟通，最后在执行层面就可能会变形。这样的人越多，执行起来就越走样。</p>
<p>所以一次成功的会议应该让每个人能有机会充分表达自己的想法，尽量听人把话说完。可以采取的一种技巧是让每个人轮流表达一下自己的观点，这样可以提供机会让那些不想开口的人说话，避免他们把问题带回去。据我观察这样的人往往不在少数。</p>
<p>让想法达成一致的会议，我们称之为「对焦」。在阿里，每年年初都会有一系列战略对焦的会议，让上下层员工、协同、合作部门在目标和想法上达成一致。人类社会太复杂了，每个人身处自己的位置都会有自己的想法和局限性，所以对焦很重要。</p>
<p>我们每天的工作大多数时候都在会议或会谈中进行，如果不把会议利用好，提高效率，那就是在浪费生命。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/30/meeting/" data-id="cj4quikwj000kne5sz9qjjonl" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Meeting/">Meeting</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Work/">Work</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Catégories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Books/">Books</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Movie/">Movie</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Objective-C/">Objective-C</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Vps/">Vps</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Work/">Work</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/npm/">npm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/性能/">性能</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/性能优化/">性能优化</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Mot-clés</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Books/">Books</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Debian/">Debian</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Digitalocean/">Digitalocean</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dropbox/">Dropbox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FinalSpeed/">FinalSpeed</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Life/">Life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Meeting/">Meeting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Movie/">Movie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shadowsocks/">Shadowsocks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TV/">TV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vps/">Vps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vultr/">Vultr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Work/">Work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ftp/">ftp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/next/">next</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sidebar/">sidebar</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后端开发/">后端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/安全/">安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/极路由/">极路由</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/美剧/">美剧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自动发布/">自动发布</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/词/">词</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/黑客/">黑客</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Nuage de mot-clés</h3>
    <div class="widget tagcloud">
      <a href="/tags/Books/" style="font-size: 10px;">Books</a> <a href="/tags/Debian/" style="font-size: 10px;">Debian</a> <a href="/tags/Digitalocean/" style="font-size: 10px;">Digitalocean</a> <a href="/tags/Dropbox/" style="font-size: 10px;">Dropbox</a> <a href="/tags/FinalSpeed/" style="font-size: 10px;">FinalSpeed</a> <a href="/tags/Life/" style="font-size: 10px;">Life</a> <a href="/tags/Meeting/" style="font-size: 10px;">Meeting</a> <a href="/tags/Movie/" style="font-size: 10px;">Movie</a> <a href="/tags/Python/" style="font-size: 13.33px;">Python</a> <a href="/tags/Shadowsocks/" style="font-size: 16.67px;">Shadowsocks</a> <a href="/tags/TV/" style="font-size: 10px;">TV</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/Vps/" style="font-size: 20px;">Vps</a> <a href="/tags/Vultr/" style="font-size: 10px;">Vultr</a> <a href="/tags/Work/" style="font-size: 10px;">Work</a> <a href="/tags/ftp/" style="font-size: 10px;">ftp</a> <a href="/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/tags/next/" style="font-size: 10px;">next</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/sidebar/" style="font-size: 10px;">sidebar</a> <a href="/tags/后端开发/" style="font-size: 10px;">后端开发</a> <a href="/tags/安全/" style="font-size: 10px;">安全</a> <a href="/tags/极路由/" style="font-size: 10px;">极路由</a> <a href="/tags/爬虫/" style="font-size: 13.33px;">爬虫</a> <a href="/tags/美剧/" style="font-size: 10px;">美剧</a> <a href="/tags/自动发布/" style="font-size: 10px;">自动发布</a> <a href="/tags/词/" style="font-size: 10px;">词</a> <a href="/tags/黑客/" style="font-size: 10px;">黑客</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/03/05/spark/">Spark：一个高效的分布式计算系统</a>
          </li>
        
          <li>
            <a href="/2016/03/05/docker-develop/">利用Docker构建开发环境</a>
          </li>
        
          <li>
            <a href="/2016/03/05/norm/">创业公司的这些问题…其实是常态</a>
          </li>
        
          <li>
            <a href="/2016/02/28/mac-ubuntu-finalspeed/">FinalSpeed搭建配置</a>
          </li>
        
          <li>
            <a href="/2016/02/25/python-mysql/">Python操作Mysql</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>